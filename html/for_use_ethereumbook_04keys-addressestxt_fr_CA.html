<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Cryptographie</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="keys_addresses">Cryptographie</h2>
<div class="sectionbody">
<div class="paragraph data-line-4">
<p>One of Ethereum&#8217;s foundational technologies is <em>cryptography</em>, which is a branch of mathematics used extensively in computer security. Cryptography means "secret writing" in Greek, but the study of cryptography encompasses more than just secret writing, which is referred to as <em>encryption</em>. Cryptography can, for example, also be used to prove knowledge of a secret without revealing that secret (e.g., with a digital signature), or to prove the authenticity of data (e.g., with digital fingerprints, also known as "hashes"). These types of cryptographic proofs are mathematical tools critical to the operation of the Ethereum platform (and, indeed, all blockchain systems), and are also extensively used in Ethereum applications. </p>
</div>
<div class="paragraph data-line-6">
<p>Note that, at the time of publication, no part of the Ethereum protocol involves encryption; that is to say all communications with the Ethereum platform and between nodes (including transaction data) are unencrypted and can (necessarily) be read by anyone. This is so everyone can verify the correctness of state updates and consensus can be reached. In the future, advanced cryptographic tools, such as zero knowledge proofs and homomorphic encryption, will be available that will allow for some encrypted calculations to be recorded on the blockchain while still enabling consensus; however, while provision has been made for them, they have yet to be deployed.</p>
</div>
<div class="paragraph data-line-8">
<p>In this chapter we will introduce some of the cryptography used in Ethereum: namely public key cryptography (PKC), which is used to control ownership of funds, in the form of private keys and addresses.</p>
</div>
<div class="sect2 data-line-11">
<h3 id="keys_addresses_intro">Keys and Addresses</h3>
<div class="paragraph data-line-13">
<p>As we saw earlier in the book, Ethereum has two different types of accounts: <em>externally owned accounts</em> (EOAs) and <em>contracts</em>. Ownership of ether by EOAs is established through digital <em>private keys</em>, <em>Ethereum addresses</em>, and <em>digital signatures</em>. The private keys are at the heart of all user interaction with Ethereum. In fact, account addresses are derived directly from private keys: a private key uniquely determines a single Ethereum address, also known as an <em>account</em>.</p>
</div>
<div class="paragraph data-line-15">
<p>Private keys are not used directly in the Ethereum system in any way; they are never transmitted or stored on Ethereum. That is to say that private keys should remain private and never appear in messages passed to the network, nor should they be stored on-chain; only account addresses and digital signatures are ever transmitted and stored on the Ethereum system. For more information on how to keep private keys safe and secure, see <a href="#control_responsibility">[control_responsibility]</a> and <a href="#wallets_chapter">[wallets_chapter]</a>.</p>
</div>
<div class="paragraph data-line-17">
<p>Access and control of funds is achieved with digital signatures, which are also created using the private key. Ethereum transactions require a valid digital signature to be included in the blockchain. Anyone with a copy of a private key has control of the corresponding account and any ether it holds. Assuming a user keeps their private key safe, the digital signatures in Ethereum transactions prove the true owner of the funds, because they prove ownership of the private key.</p>
</div>
<div class="paragraph data-line-19">
<p>In public key cryptography&#x2013;based systems, such as that used by Ethereum, keys come in pairs consisting of a private (secret) key and a public key. Think of the public key as similar to a bank account number, and the private key as similar to the secret PIN; it is the latter that provides control over the account, and the former that identifies it to others. The private keys themselves are very rarely seen by Ethereum users; for the most part, they are stored (in encrypted form) in special files and managed by Ethereum wallet software.</p>
</div>
<div class="paragraph data-line-21">
<p>In the payment portion of an Ethereum transaction, the intended recipient is represented by an Ethereum address, which is used in the same way as the beneficiary account details of a bank transfer. As we will see in more detail shortly, an Ethereum address for an EOA is generated from the public key portion of a key pair. However, not all Ethereum addresses represent public–private key pairs; they can also represent contracts, which, as we will see in <a href="#smart_contracts_chapter">[smart_contracts_chapter]</a>, are not backed by private keys.</p>
</div>
<div class="paragraph data-line-23">
<p>In the rest of this chapter, we will first explore basic cryptography in a bit more detail and explain the mathematics used in Ethereum. Then we will look at how keys are generated, stored, and managed.  Finally, we will review the various encoding formats used to represent private keys, public keys, and addresses.</p>
</div>
</div>
<div class="sect2 data-line-26">
<h3 id="pkc">Public Key Cryptography and Cryptocurrency</h3>
<div class="paragraph data-line-28">
<p>Public key cryptography (also called "asymmetric cryptography") is a core part of modern-day information security. The key exchange protocol, first published in the 1970s by Martin Hellman, Whitfield Diffie, and Ralph Merkle, was a monumental breakthrough that incited the first big wave of public interest in the field of cryptography. Before the 1970s, strong cryptographic knowledge was kept secret by <span class="keep-together">governments</span>.</p>
</div>
<div class="paragraph data-line-30">
<p>Public key cryptography uses unique keys to secure information. These keys are based on mathematical functions that have a special property: it is easy to calculate them, but hard to calculate their inverse. Based on these functions, cryptography enables the creation of digital secrets and unforgeable digital signatures, which are secured by the laws of mathematics.</p>
</div>
<div class="paragraph data-line-32">
<p>For example, multiplying two large prime numbers together is trivial. But given the product of two large primes, it is very difficult to find the prime factors (a problem called <em>prime factorization</em>). Let&#8217;s say we present the number 8,018,009 and tell you it is the product of two primes. Finding those two primes is much harder for you than it was for me to multiply them to produce 8,018,009.</p>
</div>
<div class="paragraph data-line-34">
<p>Some of these mathematical functions can be inverted easily if you know some secret information. In the preceding example, if I tell you that one of the prime factors is 2,003, you can trivially find the other one with a simple division: 8,018,009 ÷ 2,003 = 4,003. Such functions are often called <em>trapdoor functions</em> because they are very difficult to invert unless you are given a piece of secret information that can be used as a shortcut to reverse the function.</p>
</div>
<div class="paragraph data-line-36">
<p>A more advanced category of mathematical functions that is useful in cryptography is based on arithmetic operations on an elliptic curve. In elliptic curve arithmetic, multiplication modulo a prime is simple but division (the inverse) is practically impossible. This is called the <em>discrete logarithm problem</em> and there are currently no known trapdoors. <em>Elliptic curve cryptography</em> is used extensively in modern computer systems and is the basis of Ethereum&#8217;s (and other cryptocurrencies') use of private keys and digital signatures.</p>
</div>
<div class="admonitionblock note data-line-39">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-40">
<p>Take a look at the following resources if you&#8217;re interested in reading more about cryptography and the mathematical functions that are used in modern cryptography:</p>
</div>
<div class="ulist data-line-42">
<ul>
<li class="data-line-42">
<p><a href="http://bit.ly/2DcwNhn" data-href="http://bit.ly/2DcwNhn">Cryptography</a></p>
</li>
<li class="data-line-44">
<p><a href="http://bit.ly/2zeZV3c" data-href="http://bit.ly/2zeZV3c">Trapdoor function</a></p>
</li>
<li class="data-line-46">
<p><a href="http://bit.ly/2ACJjnV" data-href="http://bit.ly/2ACJjnV">Prime factorization</a></p>
</li>
<li class="data-line-48">
<p><a href="http://bit.ly/2Q7mZYI" data-href="http://bit.ly/2Q7mZYI">Discrete logarithm</a></p>
</li>
<li class="data-line-50">
<p><a href="http://bit.ly/2zfeKCP" data-href="http://bit.ly/2zfeKCP">Elliptic curve cryptography</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-53">
<p>In Ethereum, we use public key cryptography (also known as asymmetric cryptography) to create the public–private key pair we have been talking about in this chapter. They are considered a "pair" because the public key is derived from the private key. Together, they represent an Ethereum account by providing, respectively, a publicly accessible account handle (the address) and private control over access to any ether in the account and over any authentication the account needs when using smart contracts. The private key controls access by being the unique piece of information needed to create <em>digital signatures</em>, which are required to sign transactions to spend any funds in the account. Digital signatures are also used to authenticate owners or users of contracts, as we will see in <a href="#smart_contracts_chapter">[smart_contracts_chapter]</a>.</p>
</div>
<div class="admonitionblock tip data-line-56">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-57">
<p>In most wallet implementations, the private and public keys are stored together as a <em>key pair</em> for convenience. However, the public key can be trivially calculated from the private key, so storing only the private key is also possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-60">
<p>A digital signature can be created to sign any message. For Ethereum transactions, the details of the transaction itself are used as the message. The mathematics of cryptography&#x2014;in this case, elliptic curve cryptography&#x2014;provides a way for the message (i.e., the transaction details) to be combined with the private key to create a code that can only be produced with knowledge of the private key. That
code is called the digital signature. Note that an Ethereum transaction is basically a request to access a particular account with a particular Ethereum address. When a transaction is sent to the Ethereum network in order to move funds or interact with smart contracts, it needs to be sent with a digital signature created with the private key corresponding to the Ethereum address in question. Elliptic curve mathematics means that <em>anyone</em> can verify that a transaction is valid, by checking that the digital signature matches the transaction details <em>and</em> the Ethereum address to which access is being requested. The verification doesn&#8217;t involve the private key at all; that remains private. However, the verification process determines beyond doubt that the transaction could have only come from someone with the private key that corresponds to the public key behind the Ethereum address. This is the "magic" of public key cryptography.</p>
</div>
<div class="admonitionblock tip data-line-65">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-66">
<p>There is no encryption as part of the Ethereum protocol&#x2014;all messages that are sent as part of the operation of the Ethereum network can (necessarily) be read by everyone. As such, private keys are only used to create digital signatures for transaction authentication.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-70">
<h3 id="private_keys">Private Keys</h3>
<div class="paragraph data-line-72">
<p>A private key is simply a number, picked at random. Ownership and control of the private key is the root of user control over all funds associated with the corresponding Ethereum address, as well as access to contracts that authorize that address. The private key is used to create signatures required to spend ether by proving ownership of funds used in a transaction. The private key must remain secret at all times, because revealing it to third parties is equivalent to giving them control over the ether and contracts secured by that private key. The private key must also be backed up and protected from accidental loss. If it&#8217;s lost, it cannot be recovered and the funds secured by it are lost forever too.</p>
</div>
<div class="admonitionblock tip data-line-75">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-76">
<p>The Ethereum private key is just a number. One way to pick your private keys randomly is to simply use a coin, pencil, and paper: toss a coin 256 times and you have the binary digits of a random private key you can use in an Ethereum wallet (probably&#x2014;see the next section). The public key and address can then be generated from the private key.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 data-line-80">
<h4 id="generating_private_key">Generating a Private Key from a Random Number</h4>
<div class="paragraph data-line-82">
<p>The first and most important step in generating keys is to find a secure source of entropy, or randomness. Creating an Ethereum private key essentially involves picking a number between 1 and 2<sup>256</sup>. The exact method you use to pick that number does not matter as long as it is not predictable or deterministic. Ethereum software uses the underlying operating system&#8217;s random number generator to produce 256 random bits. Usually, the OS random number generator is initialized by a human source of randomness, which is why you may be asked to wiggle your mouse around for a few seconds, or press random keys on your keyboard. An alternative could be cosmic radiation noise on the computer&#8217;s microphone channel.</p>
</div>
<div class="paragraph data-line-84">
<p>More precisely, a private key can be any nonzero number up to a very large number slightly less than 2<sup>256</sup>&#x2014;a huge 78-digit number, roughly 1.158 * 10<sup>77</sup>. The exact number shares the first 38 digits with 2<sup>256</sup> and is defined as the order of the elliptic curve used in Ethereum (see <a href="#elliptic_curve">Elliptic Curve Cryptography Explained</a>). To create a private key, we randomly pick a 256-bit number and check that it is within the valid range. In programming terms, this is usually achieved by feeding an even larger string of random bits (collected from a cryptographically secure source of randomness) into a 256-bit hash algorithm such as Keccak-256 or SHA-256, both of which will conveniently produce a 256-bit number. If the result is within the valid range, we have a suitable private key. Otherwise, we simply try again with another random number.</p>
</div>
<div class="admonitionblock tip data-line-87">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-88">
<p>2<sup>256</sup>&#x2014;the size of Ethereum&#8217;s private key space&#x2014;is an unfathomably large number. It is approximately 10<sup>77</sup> in decimal; that is, a number with 77 digits. For comparison, the visible universe is estimated to contain 10<sup>80</sup> atoms. Thus, there are almost enough private keys to give every atom in the universe an Ethereum account. If you pick a private key randomly, there is no conceivable way anyone will ever guess it or pick it themselves.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-91">
<p>Note that the private key generation process is an offline one; it does not require any communication with the Ethereum network, or indeed any communication with anyone at all. As such, in order to pick a number that no one else will ever pick, it needs to be truly random. If you choose the number yourself, the chance that someone else will try it (and then run off with your ether) is too high. Using a bad random number generator (like the pseudorandom rand function in most programming languages) is even worse, because it is even more obvious and even easier to replicate. Just like with passwords for online accounts, the private key needs to be unguessable. Fortunately, you never need to remember your private key, so you can take the best possible approach for picking it: namely, true randomness.</p>
</div>
<div class="admonitionblock warning data-line-94">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-95">
<p>Do not write your own code to create a random number or use a "simple" random number generator offered by your programming language. It is vital that you use a cryptographically secure pseudo-random number generator (such as CSPRNG) with a seed from a source of sufficient entropy. Study the documentation of the random number generator library you choose to make sure it is cryptographically secure. Correct implementation of the CSPRNG library is critical to the security of the keys.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-98">
<p>The following is a randomly generated private key shown in hexadecimal format (256 bits shown as 64 hexadecimal digits, each 4 bits):</p>
</div>
<div id="prv_key_example" class="listingblock data-line-101">
<div class="content">
<pre>f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315</pre>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-107">
<h3 id="pubkey">Public Keys</h3>
<div class="paragraph data-line-109">
<p>An Ethereum public key is a <em>point</em> on an elliptic curve, meaning it is a set of <em>x</em> and <em>y</em> coordinates that satisfy the elliptic curve equation.</p>
</div>
<div class="paragraph data-line-111">
<p>In simpler terms, an Ethereum public key is two numbers, joined together. These numbers are produced from the private key by a calculation that can <em>only go one way</em>. That means that it is trivial to calculate a public key if you have the private key, but you cannot calculate the private key from the public key.</p>
</div>
<div class="admonitionblock warning data-line-114">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-115">
<p>MATH is about to happen! Don&#8217;t panic. If you start to get lost at any point in the following paragraphs, you can skip the next few sections. There are many tools and libraries that will do the math for you.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-118">
<p>The public key is calculated from the private key using elliptic curve multiplication, which is practically irreversible: <em>K</em> = <em>k</em> * <em>G</em>, where <em>k</em> is the private key, <em>G</em> is a constant point called the <em>generator point</em>, <em>K</em> is the resulting public key, and * is the special elliptic curve "multiplication" operator. Note that elliptic curve multiplication is not like normal multiplication. It shares functional attributes with normal multiplication, but that is about it. For example, the reverse operation (which would be division for normal numbers), known as "finding the discrete logarithm&#x201d;&#x2014;i.e., calculating <em>k</em> if you know <em>K</em>&#x2014;is as difficult as trying all possible values of <em>k</em> (a brute-force search that will likely take more time than this universe will allow for).</p>
</div>
<div class="paragraph data-line-120">
<p>In simpler terms: arithmetic on the elliptic curve is different from "regular" integer arithmetic. A point (<em>G</em>) can be multiplied by an integer (<em>k</em>) to produce another point (<em>K</em>). But there is no such thing as <em>division</em>, so it is not possible to simply "divide" the public key <em>K</em> by the point <em>G</em> to calculate the private key <em>k</em>. This is the one-way mathematical function described in <a href="#pkc">Public Key Cryptography and Cryptocurrency</a>.</p>
</div>
<div class="admonitionblock note data-line-123">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-124">
<p>Elliptic curve multiplication is a type of function that cryptographers call a "one-way" function: it is easy to do in one direction (multiplication) and impossible to do in the reverse direction (division). The owner of the private key can easily create the public key and then share it with the world, knowing that no one can reverse the function and calculate the private key from the public key. This mathematical trick becomes the basis for unforgeable and secure digital signatures that prove ownership of Ethereum funds and control of contracts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-127">
<p>Before we demonstrate how to generate a public key from a private key, let&#8217;s look at elliptic curve cryptography in a bit more detail.</p>
</div>
<div class="sect3 data-line-131">
<h4 id="elliptic_curve">Elliptic Curve Cryptography Explained</h4>
<div class="paragraph data-line-133">
<p>Elliptic curve cryptography is a type of asymmetric or public key cryptography based on the discrete logarithm problem as expressed by addition and multiplication on the points of an elliptic curve.</p>
</div>
<div class="paragraph data-line-135">
<p><a href="#ecc-curve">A visualization of an elliptic curve</a> is an example of an elliptic curve, similar to that used by Ethereum.</p>
</div>
<div class="admonitionblock note data-line-138">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-139">
<p>Ethereum uses the exact same elliptic curve, called secp256k1, as Bitcoin. That makes it possible to reuse many of the elliptic curve libraries and tools from Bitcoin.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ecc-curve" class="imageblock data-line-144">
<div class="content">
<img src="images/simple_elliptic_curve.png" alt="ecc-curve">
</div>
<div class="title">Figure 1. A visualization of an elliptic curve</div>
</div>
<div class="paragraph data-line-146">
<p>Ethereum uses a specific elliptic curve and set of mathematical constants, as defined in a standard called secp256k1, established by the US National Institute of Standards and Technology (NIST). The secp256k1 curve is defined by the following function, which produces an elliptic curve:</p>
</div>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mrow>
      <msup><mi>y</mi> <mn>2</mn> </msup>
      <mo>=</mo>
      <mrow>
        <mo>(</mo>
        <msup><mi>x</mi> <mn>3</mn> </msup>
        <mo>+</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mspace width="3.33333pt"/>
    <mtext>over</mtext>
    <mspace width="3.33333pt"/>
    <mrow>
      <mo>(</mo>
      <msub><mi>&#x1d53d;</mi> <mi>p</mi> </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
<div class="paragraph data-line-176">
<p>or:</p>
</div>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msup><mi>y</mi> <mn>2</mn> </msup>
    <mspace width="3.33333pt"/>
    <mo form="prefix">mod</mo>
    <mspace width="0.277778em"/>
    <mi>p</mi>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <msup><mi>x</mi> <mn>3</mn> </msup>
      <mo>+</mo>
      <mn>7</mn>
      <mo>)</mo>
    </mrow>
    <mspace width="3.33333pt"/>
    <mo form="prefix">mod</mo>
    <mspace width="0.277778em"/>
    <mi>p</mi>
  </mrow>
</math>
</div>
<div class="paragraph data-line-204">
<p>The <em>mod p</em> (modulo prime number <em>p</em>) indicates that this curve is over a finite field of prime order <em>p</em>, also written as \(\( \mathbb{F}_p \)\), where <em>p</em> = 2<sup>256</sup> – 2<sup>32</sup> – 2<sup>9</sup> – 2<sup>8</sup> – 2<sup>7</sup> – 2<sup>6</sup> – 2<sup>4</sup> – 1, which is a very large prime number.</p>
</div>
<div class="paragraph data-line-206">
<p>Because this curve is defined over a finite field of prime order instead of over the real numbers, it looks like a pattern of dots scattered in two dimensions, which makes it difficult to visualize. However, the math is identical to that of an elliptic curve over real numbers. As an example, <a href="#ecc-over-F17-math">Elliptic curve cryptography: visualizing an elliptic curve over F(p), with p=17</a> shows the same elliptic curve over a much smaller finite field of prime order 17, showing a pattern of dots on a grid. The secp256k1 Ethereum elliptic curve can be thought of as a much more complex pattern of dots on an unfathomably large grid.</p>
</div>
<div id="ecc-over-F17-math" class="imageblock smallersixty data-line-211">
<div class="content">
<img src="images/ec_over_small_prime_field.png" alt="ecc-over-F17-math">
</div>
<div class="title">Figure 2. Elliptic curve cryptography: visualizing an elliptic curve over F(p), with p=17</div>
</div>
<div class="paragraph data-line-213">
<p>So, for example, the following is a point <em>Q</em> with coordinates (<em>x</em>,<em>y</em>) that is a point on the secp256k1 curve:</p>
</div>
<div id="coordinates_example" class="listingblock data-line-216">
<div class="content">
<pre>Q =
(49790390825249384486033144355916864607616083520101638681403973749255924539515,
59574132161899900045862086493921015780032175291755807399284007721050341297360)</pre>
</div>
</div>
<div class="paragraph data-line-222">
<p><a href="#example_1">[example_1]</a> shows how you can check this yourself using Python. The variables x and y are the coordinates of the point <em>Q</em>, as in the preceding example. The variable p is the prime order of the elliptic curve (the prime that is used for all the modulo operations). The last line of Python is the elliptic curve equation (the % operator in Python is the modulo operator). If x and y are indeed the coordinates of a point on the elliptic curve, then they satisfy the equation and the result is zero (0L is a long integer with value zero). Try it yourself, by typing **python** on a command line and copying each line (after the prompt &gt;&gt;&gt;) from the listing.</p>
</div>
<div data-type="example" id="example_1">
<h5>Using Python to confirm that this point is on the elliptic curve</h5>
<pre data-type="programlisting">
Python 3.4.0 (default, Mar 30 2014, 19:23:13)
[GCC 4.2.1 Compatible Apple LLVM 5.1 (clang-503.0.38)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> <strong>p = 115792089237316195423570985008687907853269984665640564039457584007908834 \
671663</strong>
>>> <strong>x = 49790390825249384486033144355916864607616083520101638681403973749255924539515</strong>
>>> <strong>y = 59574132161899900045862086493921015780032175291755807399284007721050341297360</strong>
>>> <strong>(x ** 3 + 7 - y**2) % p</strong>
0L
</pre>
</div>
</div>
<div class="sect3 data-line-242">
<h4 id="EC_math">Elliptic Curve Arithmetic Operations</h4>
<div class="paragraph data-line-244">
<p>A lot of elliptic curve math looks and works very much like the integer arithmetic we learned at school. Specifically, we can define an addition operator, which instead of jumping along the number line is jumping to other points on the curve. Once we have the addition operator, we can also define multiplication of a point and a whole number, which is equivalent to repeated addition.</p>
</div>
<div class="paragraph data-line-246">
<p>Elliptic curve addition is defined such that given two points <em>P</em><sub>1</sub> and <em>P</em><sub>2</sub> on the elliptic curve, there is a third point <em>P</em><sub>3</sub> = <em>P</em><sub>1</sub> + <em>P</em><sub>2</sub>, also on the elliptic curve.</p>
</div>
<div class="paragraph data-line-248">
<p>Geometrically, this third point <em>P</em><sub>3</sub> is calculated by drawing a line between <em>P</em><sub>1</sub> and <em>P</em><sub>2</sub>. This line will intersect the elliptic curve in exactly one additional place (amazingly). Call this point <em>P</em><sub>3</sub>' = (<em>x</em>, <em>y</em>). Then reflect in the x-axis to get <em>P</em><sub>3</sub> = (<em>x</em>, <em>–y</em>).</p>
</div>
<div class="paragraph data-line-250">
<p>If <em>P</em><sub>1</sub> and <em>P</em><sub>2</sub> are the same point, the line "between" <em>P</em><sub>1</sub> and <em>P</em><sub>2</sub> should extend to be the tangent to the curve at this point <em>P</em><sub>1</sub>. This tangent will intersect the curve at exactly one new point. You can use techniques from calculus to determine the slope of the tangent line. Curiously, these techniques work, even though we are restricting our interest to points on the curve with two integer coordinates!</p>
</div>
<div class="paragraph data-line-252">
<p>In elliptic curve math, there is also a point called the "point at infinity," which roughly corresponds to the role of the number zero in addition. On computers, it&#8217;s sometimes represented by <em>x</em> = <em>y</em> = 0 (which doesn&#8217;t satisfy the elliptic curve equation, but it&#8217;s an easy separate case that can be checked). There are a couple of special cases that explain the need for the point at infinity.</p>
</div>
<div class="paragraph data-line-254">
<p>In some cases (e.g., if <em>P</em><sub>1</sub> and <em>P</em><sub>2</sub> have the same <em>x</em> values but different <em>y</em> values), the line will be exactly vertical, in which case <em>P</em><sub>3</sub> = the point at infinity.</p>
</div>
<div class="paragraph data-line-256">
<p>If <em>P</em><sub>1</sub> is the point at infinity, then <em>P</em><sub>1</sub> + <em>P</em><sub>2</sub> = <em>P</em><sub>2</sub>. Similarly, if <em>P</em><sub>2</sub> is the point at infinity, then <em>P</em><sub>1</sub> + <em>P</em><sub>2</sub> = <em>P</em><sub>1</sub>. This shows how the point at infinity plays the role that zero plays in "normal" arithmetic.</p>
</div>
<div class="paragraph data-line-258">
<p>It turns out that + is associative, which means that (<em>A</em> + <em>B</em>) + <em>C</em> = <em>A</em> + (<em>B</em> + <em>C</em>). That means we can write <em>A</em> + <em>B</em> + <em>C</em> (without parentheses) without ambiguity.</p>
</div>
<div class="paragraph data-line-260">
<p>Now that we have defined addition, we can define multiplication in the standard way that extends addition. For a point <em>P</em> on the elliptic curve, if <em>k</em> is a whole number, then <em>k</em> * <em>P</em> = <em>P</em> + <em>P</em> + <em>P</em> + &#8230;&#8203; + <em>P</em> (<em>k</em> times). Note that <em>k</em> is sometimes (perhaps confusingly) called an "exponent" in this case.</p>
</div>
</div>
<div class="sect3 data-line-263">
<h4 id="public_key_derivation">Generating a Public Key</h4>
<div class="paragraph data-line-265">
<p>Starting with a private key in the form of a randomly generated number <em>k</em>, we multiply it by a predetermined point on the curve called the <em>generator point</em> <em>G</em> to produce another point somewhere else on the curve, which is the corresponding public key <em>K</em>:</p>
</div>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mi>K</mi>
    <mo>=</mo>
    <mi>k</mi>
    <mo>*</mo>
    <mi>G</mi>
  </mrow>
</math>
</div>
<div class="paragraph data-line-281">
<p>The generator point is specified as part of the secp256k1 standard; it is the same for all implementations of secp256k1, and all keys derived from that curve use the same point <em>G</em>. Because the generator point is always the same for all Ethereum users, a private key <em>k</em> multiplied with <em>G</em> will always result in the same public key <em>K</em>. The relationship between <em>k</em> and <em>K</em> is fixed, but can only be calculated in one direction, from <em>k</em> to <em>K</em>. That&#8217;s why an Ethereum address (derived from <em>K</em>) can be shared with anyone and does not reveal the user&#8217;s private key (<em>k</em>).</p>
</div>
<div class="paragraph data-line-283">
<p>As we described in the previous section, the multiplication of <em>k</em> * <em>G</em> is equivalent to repeated addition, so <em>G</em> + <em>G</em> + <em>G</em> + &#8230;&#8203; + <em>G</em>, repeated <em>k</em> times. In summary, to produce a public key <em>K</em> from a private key <em>k</em>, we add the generator point <em>G</em> to itself, <em>k</em> times.</p>
</div>
<div class="admonitionblock tip data-line-286">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-287">
<p>A private key can be converted into a public key, but a public key cannot be converted back into a private key, because the math only works one way.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-290">
<p>Let&#8217;s apply this calculation to find the public key for the specific private key we showed you in <a href="#private_keys">Private Keys</a>:</p>
</div>
<div id="example_privkey" class="listingblock data-line-295">
<div class="title">Example private key to public key calculation</div>
<div class="content">
<pre>K = f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315 * G</pre>
</div>
</div>
<div class="paragraph data-line-299">
<p>A cryptographic library can help us calculate <em>K</em>, using elliptic curve multiplication. The resulting public key <em>K</em> is defined as the point:</p>
</div>
<div class="listingblock data-line-301">
<div class="content">
<pre>K = (x, y)</pre>
</div>
</div>
<div class="paragraph data-line-305">
<p>where:</p>
</div>
<div class="listingblock data-line-307">
<div class="content">
<pre>x = 6e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b
y = 83b5c38e5e2b0c8529d7fa3f64d46daa1ece2d9ac14cab9477d042c84c32ccd0</pre>
</div>
</div>
<div class="paragraph data-line-312">
<p>In Ethereum you may see public keys represented as a serialization of 130 hexadecimal characters (65 bytes). This is adopted from a standard serialization format proposed by the industry consortium Standards for Efficient Cryptography Group (SECG), documented in <a href="http://www.secg.org/sec1-v2.pdf" data-href="http://www.secg.org/sec1-v2.pdf">Standards for Efficient Cryptography (SEC1)</a>. The standard defines four possible prefixes that can be used to identify points on an elliptic curve, listed in <a href="#EC_prefix_table">Serialized EC public key prefixes</a>.</p>
</div>
<table id="EC_prefix_table" class="tableblock frame-all grid-all stretch data-line-317">
<caption class="title">Table 1. Serialized EC public key prefixes</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Length (bytes counting prefix)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Point at infinity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncompressed point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compressed point with even y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">33</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compressed point with odd y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">33</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-325">
<p>Ethereum only uses uncompressed public keys; therefore the only prefix that is relevant is (hex) 04. The serialization concatenates the <em>x</em> and <em>y</em> coordinates of the public key:</p>
</div>
<div id="concat_coordinates" class="listingblock data-line-328">
<div class="content">
<pre>04 + x-coordinate (32 bytes/64 hex) + y-coordinate (32 bytes/64 hex)</pre>
</div>
</div>
<div class="paragraph data-line-332">
<p>Therefore, the public key we calculated earlier is serialized as:</p>
</div>
<div id="serialized_pubkey" class="listingblock data-line-335">
<div class="content">
<pre>046e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b83b5c38e5e2b0 \
c8529d7fa3f64d46daa1ece2d9ac14cab9477d042c84c32ccd0</pre>
</div>
</div>
</div>
<div class="sect3 data-line-341">
<h4 id="EC_lib">Elliptic Curve Libraries</h4>
<div class="paragraph data-line-343">
<p>There are a couple of implementations of the secp256k1 elliptic curve that are used in cryptocurrency-related projects:</p>
</div>
<div class="dlist data-line-345">
<dl>
<dt class="hdlist1"><a href="https://www.openssl.org/" data-href="https://www.openssl.org/">OpenSSL</a></dt>
<dd>
<p>The OpenSSL library offers a comprehensive set of cryptographic primitives, including a full implementation of secp256k1. For example, to derive the public key, the function EC_POINT_mul can be used.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoin-core/secp256k1" data-href="https://github.com/bitcoin-core/secp256k1">libsecp256k1</a></dt>
<dd>
<p>Bitcoin Core&#8217;s libsecp256k1 is a C-language implementation of the secp256k1 elliptic curve and other cryptographic primitives. It was written from scratch to replace OpenSSL in Bitcoin Core software, and is considered superior in both performance and security.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2 data-line-350">
<h3 id="hash_functions">Cryptographic Hash Functions</h3>
<div class="paragraph data-line-352">
<p>Cryptographic hash functions are used throughout Ethereum. In fact, hash functions are used extensively in almost all cryptographic systems&#x2014;a fact captured by <span class="keep-together">cryptographer</span> <a href="http://bit.ly/2Q79qZp" data-href="http://bit.ly/2Q79qZp">Bruce Schneier</a>, who said, "Much more than encryption algorithms, one-way hash functions are the workhorses of modern cryptography."</p>
</div>
<div class="paragraph data-line-354">
<p>In this section we will discuss hash functions, explore their basic properties, and see how those properties make them so useful in so many areas of modern cryptography. We address hash functions here because they are part of the transformation of Ethereum public keys into addresses. They can also be used to create <em>digital fingerprints</em>, which aid in the verification of data.</p>
</div>
<div class="paragraph data-line-356">
<p>In simple terms, a <a href="http://bit.ly/2CR26gD" data-href="http://bit.ly/2CR26gD"><em>hash function</em></a> is &#x201c;any function that can be used to map data of arbitrary size to data of fixed size.&#x201d; The input to a hash function is called a <em>pre-image</em>, the <em>message</em>, or simply the <em>input data</em>. The output is called the <em>hash</em>. <a href="http://bit.ly/2Jrn3jM" data-href="http://bit.ly/2Jrn3jM"><em>Cryptographic hash functions</em></a> are a special subcategory that have specific properties that are useful to secure platforms, such as Ethereum.</p>
</div>
<div class="paragraph data-line-358">
<p>A cryptographic hash function is a <em>one-way</em> hash function that maps data of arbitrary size to a fixed-size string of bits. The "one-way" nature means that it is computationally infeasible to recreate the input data if one only knows the output hash. The only way to determine a possible input is to conduct a brute-force search, checking each candidate for a matching output; given that the search space is virtually infinite, it is easy to understand the practical impossibility of the task. Even if you find some input data that creates a matching hash, it may not be the original input data: hash functions are "many-to-one" functions. Finding two sets of input data that hash to the same output is called finding a <em>hash collision</em>. Roughly speaking, the better the hash function, the rarer hash collisions are. For Ethereum, they are effectively impossible.</p>
</div>
<div class="paragraph data-line-360">
<p>Let&#8217;s take a closer look at the main properties of cryptographic hash functions. These include:</p>
</div>
<div class="dlist data-line-362">
<dl>
<dt class="hdlist1">Determinism</dt>
<dd>
<p>A given input message always produces the same hash output.</p>
</dd>
<dt class="hdlist1">Verifiability</dt>
<dd>
<p>Computing the hash of a message is efficient (linear complexity).</p>
</dd>
<dt class="hdlist1">Noncorrelation</dt>
<dd>
<p>A small change to the message (e.g., a 1-bit change) should change the hash output so extensively that it cannot be correlated to the hash of the original message.</p>
</dd>
<dt class="hdlist1">Irreversibility</dt>
<dd>
<p>Computing the message from its hash is infeasible, equivalent to a brute-force search through all possible messages.</p>
</dd>
<dt class="hdlist1">Collision protection</dt>
<dd>
<p>It should be infeasible to calculate two different messages that produce the same hash output.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-372">
<p>Resistance to hash collisions is particularly important for avoiding digital signature forgery in Ethereum.</p>
</div>
<div class="paragraph data-line-374">
<p>The combination of these properties make cryptographic hash functions useful for a broad range of security applications, including:</p>
</div>
<div class="ulist data-line-376">
<ul>
<li class="data-line-376">
<p>Data fingerprinting</p>
</li>
<li class="data-line-377">
<p>Message integrity (error detection)</p>
</li>
<li class="data-line-378">
<p>Proof of work</p>
</li>
<li class="data-line-379">
<p>Authentication (password hashing and key stretching)</p>
</li>
<li class="data-line-380">
<p>Pseudorandom number generators</p>
</li>
<li class="data-line-381">
<p>Message commitment (commit–reveal mechanisms)</p>
</li>
<li class="data-line-382">
<p>Unique identifiers</p>
</li>
</ul>
</div>
<div class="paragraph data-line-384">
<p>We will find many of these in Ethereum as we progress through the various layers of the system.</p>
</div>
<div class="sect3 data-line-387">
<h4 id="keccak256">Ethereum&#8217;s Cryptographic Hash Function: Keccak-256</h4>
<div class="paragraph data-line-389">
<p>Ethereum uses the <em>Keccak-256</em> cryptographic hash function in many places. Keccak-256 was designed as a candidate for the SHA-3 Cryptographic Hash Function Competition held in 2007 by the National Institute of Science and Technology. Keccak was the winning algorithm, which became standardized as Federal Information Processing Standard (FIPS) 202 in 2015.</p>
</div>
<div class="paragraph data-line-391">
<p>However, during the period when Ethereum was developed, the NIST standardization was not yet finalized. NIST adjusted some of the parameters of Keccak after the completion of the standards process, allegedly to improve its efficiency. This was occurring at the same time as heroic whistleblower Edward Snowden revealed documents that imply that NIST may have been improperly influenced by the National Security Agency to intentionally weaken the Dual_EC_DRBG random-number generator standard, effectively placing a backdoor in the standard random number generator. The result of this controversy was a backlash against the proposed changes and a significant delay in the standardization of SHA-3. At the time, the Ethereum Foundation decided to implement the original Keccak algorithm, as proposed by its inventors, rather than the SHA-3 standard as modified by NIST.</p>
</div>
<div class="admonitionblock warning data-line-394">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-395">
<p>While you may see "SHA-3" mentioned throughout Ethereum documents and code, many if not all of those instances actually refer to Keccak-256, not the finalized FIPS-202 SHA-3 standard. The implementation differences are slight, having to do with padding parameters, but they are significant in that Keccak-256 produces different hash outputs from FIPS-202 SHA-3 for the same input.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-399">
<h4 id="which_hash">Which Hash Function Am I Using?</h4>
<div class="paragraph data-line-401">
<p>How can you tell if the software library you are using implements FIPS-202 SHA-3 or Keccak-256, if both might be called "SHA-3"?</p>
</div>
<div class="paragraph data-line-403">
<p>An easy way to tell is to use a <em>test vector</em>, an expected output for a given input. The test most commonly used for a hash function is the <em>empty input</em>. If you run the hash function with an empty string as input you should see the following results:</p>
</div>
<div class="listingblock data-line-405">
<div class="content">
<pre>Keccak256("") =
  c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470

SHA3("") =
  a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a</pre>
</div>
</div>
<div class="paragraph data-line-414">
<p>Regardless of what the function is called, you can test it to see whether it is the original Keccak-256 or the final NIST standard FIPS-202 SHA-3 by running this simple test. Remember, Ethereum uses Keccak-256, even though it is often called SHA-3 in the code.</p>
</div>
<div class="admonitionblock note data-line-417">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-418">
<p>Due to the confusion created by the difference between the hash function used in Ethereum (Keccak-256) and the finalized standard (FIP-202 SHA-3), there is an effort underway to rename all instances of sha3 in all code, opcodes, and libraries to keccak256. See <a href="https://github.com/ethereum/EIPs/issues/59" data-href="https://github.com/ethereum/EIPs/issues/59">ERC59</a> for details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-422">
<p>Next, let&#8217;s examine the first application of Keccak-256 in Ethereum, which is to produce Ethereum addresses from public keys.</p>
</div>
</div>
</div>
<div class="sect2 data-line-425">
<h3 id="eth_address">Ethereum Addresses</h3>
<div class="paragraph data-line-427">
<p>Ethereum addresses are <em>unique identifiers</em> that are derived from public keys or contracts using the Keccak-256 one-way hash function.</p>
</div>
<div class="paragraph data-line-429">
<p>In our previous examples, we started with a private key and used elliptic curve multiplication to derive a public key:</p>
</div>
<div class="paragraph pagebreak-before data-line-432">
<p>Private key <em>k</em>:</p>
</div>
<div class="listingblock data-line-434">
<div class="content">
<pre>k = f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315</pre>
</div>
</div>
<div id="concat_pubkey" class="paragraph data-line-439">
<p>Public key <em>K</em> (<em>x</em> and <em>y</em> coordinates concatenated and shown as hex):</p>
</div>
<div class="listingblock data-line-441">
<div class="content">
<pre>K = 6e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b83b5c38e5e...</pre>
</div>
</div>
<div class="admonitionblock note data-line-446">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-447">
<p>It is worth noting that the public key is not formatted with the prefix (hex) 04 when the address is calculated.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-450">
<p>We use Keccak-256 to calculate the <em>hash</em> of this public key:</p>
</div>
<div id="calculate_hash" class="listingblock data-line-453">
<div class="content">
<pre>Keccak256(K) = 2a5bc342ed616b5ba5732269001d3f1ef827552ae1114027bd3ecf1f086ba0f9</pre>
</div>
</div>
<div class="paragraph data-line-457">
<p>Then we keep only the last 20 bytes (least significant bytes), which is our Ethereum address:</p>
</div>
<div id="keep_last_20" class="listingblock data-line-460">
<div class="content">
<pre>001d3f1ef827552ae1114027bd3ecf1f086ba0f9</pre>
</div>
</div>
<div class="paragraph data-line-464">
<p>Most often you will see Ethereum addresses with the prefix 0x that indicates they are hexadecimal-encoded, like this:</p>
</div>
<div id="hex_prefix" class="listingblock data-line-467">
<div class="content">
<pre>0x001d3f1ef827552ae1114027bd3ecf1f086ba0f9</pre>
</div>
</div>
<div class="sect3 data-line-472">
<h4 id="eth_address_format">Ethereum Address Formats</h4>
<div class="paragraph data-line-474">
<p>Ethereum addresses are hexadecimal numbers, identifiers derived from the last 20 bytes of the Keccak-256 hash of the public key.</p>
</div>
<div class="paragraph data-line-476">
<p>Unlike Bitcoin addresses, which are encoded in the user interface of all clients to include a built-in checksum to protect against mistyped addresses, Ethereum addresses are presented as raw hexadecimal without any checksum.</p>
</div>
<div class="paragraph data-line-478">
<p>The rationale behind that decision was that Ethereum addresses would eventually be hidden behind abstractions (such as name services) at higher layers of the system and that checksums should be added at higher layers if necessary.</p>
</div>
<div class="paragraph data-line-480">
<p>In reality, these higher layers were developed too slowly and this design choice led to a number of problems in the early days of the ecosystem, including the loss of funds due to mistyped addresses and input validation errors. Furthermore, because Ethereum name services were developed slower than initially expected, alternative encodings were adopted very slowly by wallet developers. We&#8217;ll look at a few of the encoding options next.</p>
</div>
</div>
<div class="sect3 data-line-483">
<h4 id="ICAP">Inter Exchange Client Address Protocol</h4>
<div class="paragraph data-line-485">
<p>The <em>Inter exchange Client Address Protocol</em> (ICAP) is an Ethereum address encoding that is partly compatible with the International Bank Account Number (IBAN) encoding, offering a versatile, checksummed, and interoperable encoding for Ethereum addresses. ICAP addresses can encode Ethereum addresses or common names registered with an Ethereum name registry. You can read more about ICAP on the <a href="http://bit.ly/2JsZHKu" data-href="http://bit.ly/2JsZHKu">Ethereum Wiki</a>.</p>
</div>
<div class="paragraph data-line-487">
<p>IBAN is an international standard for identifying bank account numbers, mostly used for wire transfers. It is broadly adopted in the European Single Euro Payments Area (SEPA) and beyond. IBAN is a centralized and heavily regulated service. ICAP is a decentralized but compatible implementation for Ethereum addresses.</p>
</div>
<div class="paragraph data-line-489">
<p>An IBAN consists of a string of up to 34 alphanumeric characters (case-insensitive) comprising a country code, checksum, and bank account identifier (which is country-specific).</p>
</div>
<div class="paragraph data-line-491">
<p>ICAP uses the same structure by introducing a nonstandard country code, &#x201c;XE,&#x201d; that stands for "Ethereum,&#x201d; followed by a two-character checksum and three possible variations of an account identifier:</p>
</div>
<div class="dlist data-line-493">
<dl>
<dt class="hdlist1">Direct</dt>
<dd>
<p>A big-endian base-36 integer comprised of up to 30 alphanumeric characters, representing the 155 least significant bits of an Ethereum address. Because this encoding fits less than the full 160 bits of a general Ethereum address, it only works for Ethereum addresses that start with one or more zero bytes. The advantage is that it is compatible with IBAN, in terms of the field length and checksum. Example: XE60HAMICDXSV5QXVJA7TJW47Q9CHWKJD (33 characters long).</p>
</dd>
<dt class="hdlist1">Basic</dt>
<dd>
<p>Same as the Direct encoding, except that it is 31 characters long. This allows it to encode any Ethereum address, but makes it incompatible with IBAN field validation. Example: XE18CHDJBPLTBCJ03FE9O2NS0BPOJVQCU2P (35 characters long).</p>
</dd>
<dt class="hdlist1">Indirect</dt>
<dd>
<p>Encodes an identifier that resolves to an Ethereum address through a name registry provider. It uses 16 alphanumeric characters, comprising an <em>asset identifier</em> (e.g., ETH), a name service (e.g., XREG), and a 9-character human-readable name (e.g., KITTYCATS). Example: XE##ETHXREGKITTYCATS (20 characters long), where the ## should be replaced by the two computed checksum characters.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-499">
<p>We can use the helpeth command-line tool to create ICAP addresses. You can get helpeth by installing it with:</p>
</div>
<pre data-type="programlisting">
$ <strong>npm install -g helpeth</strong>
</pre>
<div class="paragraph data-line-507">
<p>If you don&#8217;t have npm, you may have to install nodeJS first, which you can do by following the instructions at <a href="https://nodeJS.org" class="undefined" data-href="https://nodeJS.org">https://nodeJS.org</a>.</p>
</div>
<div class="paragraph data-line-509">
<p>Now that we have helpeth, let&#8217;s try creating an ICAP address with our example private key (prefixed with 0x and passed as a parameter to helpeth).</p>
</div>
<pre data-type="programlisting">
$ <strong>helpeth keyDetails \
  -p 0xf8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315</strong>

Address: 0x001d3f1ef827552ae1114027bd3ecf1f086ba0f9
ICAP: XE60 HAMI CDXS V5QX VJA7 TJW4 7Q9C HWKJ D
Public key: 0x6e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b...
</pre>
<div class="paragraph data-line-522">
<p>The helpeth command constructs a hexadecimal Ethereum address as well as an ICAP address for us. The ICAP address for our example key is:</p>
</div>
<div id="ICAP_example" class="listingblock data-line-525">
<div class="content">
<pre>XE60HAMICDXSV5QXVJA7TJW47Q9CHWKJD</pre>
</div>
</div>
<div class="paragraph data-line-529">
<p>Because our example Ethereum address happens to start with a zero byte, it can be encoded using the Direct ICAP encoding method that is valid in IBAN format. You can tell because it is 33 characters long.</p>
</div>
<div class="paragraph data-line-531">
<p>If our address did not start with a zero, it would be encoded with the Basic encoding, which would be 35 characters long and invalid as an IBAN.</p>
</div>
<div class="admonitionblock tip data-line-534">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-535">
<p>The chances of any Ethereum address starting with a zero byte are 1 in 256. To generate one like that, it will take on average 256 attempts with 256 different random private keys before we find one that works as an IBAN-compatible "Direct" encoded ICAP address.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-538">
<p>At this time, ICAP is unfortunately only supported by a few wallets.</p>
</div>
</div>
<div class="sect3 data-line-541">
<h4 id="EIP55">Hex Encoding with Checksum in Capitalization (EIP-55)</h4>
<div class="paragraph data-line-543">
<p>Due to the slow deployment of ICAP and name services, a standard was proposed by <a href="https://github.com/Ethereum/EIPs/blob/master/EIPS/eip-55.md" data-href="https://github.com/Ethereum/EIPs/blob/master/EIPS/eip-55.md">Ethereum Improvement Proposal 55 (EIP-55)</a>. EIP-55 offers a backward-compatible checksum for Ethereum addresses by modifying the capitalization of the hexadecimal address. The idea is that Ethereum addresses are case-insensitive and all wallets are supposed to accept Ethereum addresses expressed in capital or lowercase characters, without any difference in interpretation.</p>
</div>
<div class="paragraph data-line-545">
<p>By modifying the capitalization of the alphabetic characters in the address, we can convey a checksum that can be used to protect the integrity of the address against typing or reading mistakes. Wallets that do not support EIP-55 checksums simply ignore the fact that the address contains mixed capitalization, but those that do support it can validate it and detect errors with a 99.986% accuracy.</p>
</div>
<div class="paragraph data-line-547">
<p>The mixed-capitals encoding is subtle and you may not notice it at first. Our example address is:</p>
</div>
<div class="listingblock data-line-549">
<div class="content">
<pre>0x001d3f1ef827552ae1114027bd3ecf1f086ba0f9</pre>
</div>
</div>
<div class="paragraph data-line-553">
<p>With an EIP-55 mixed-capitalization checksum it becomes:</p>
</div>
<div id="mixed_capitalization" class="listingblock data-line-556">
<div class="content">
<pre>0x001d3F1ef827552Ae1114027BD3ECF1f086bA0F9</pre>
</div>
</div>
<div class="paragraph data-line-560">
<p>Can you tell the difference? Some of the alphabetic (A&#x2013;F) characters from the hexadecimal encoding alphabet are now capital, while others are lowercase.</p>
</div>
<div class="paragraph data-line-562">
<p>EIP-55 is quite simple to implement. We take the Keccak-256 hash of the lowercase hexadecimal address. This hash acts as a digital fingerprint of the address, giving us a convenient checksum. Any small change in the input (the address) should cause a big change in the resulting hash (the checksum), allowing us to detect errors effectively. The hash of our address is then encoded in the capitalization of the address itself. Let&#8217;s break it down, step by step:</p>
</div>
<div class="olist arabic data-line-564">
<ol class="arabic">
<li class="data-line-564">
<p>Hash the lowercase address, without the 0x prefix:</p>
</li>
</ol>
</div>
<div id="hash_lower_case_address" class="listingblock data-line-567">
<div class="content">
<pre>Keccak256("001d3f1ef827552ae1114027bd3ecf1f086ba0f9") =
23a69c1653e4ebbb619b0b2cb8a9bad49892a8b9695d9a19d8f673ca991deae1</pre>
</div>
</div>
<div class="olist arabic data-line-573">
<ol class="arabic" start="2">
<li class="data-line-573">
<p>Capitalize each alphabetic address character if the corresponding hex digit of the hash is greater than or equal to 0x8. This is easier to show if we line up the address and the hash:</p>
</li>
</ol>
</div>
<div id="capitalize_input" class="listingblock data-line-576">
<div class="content">
<pre>Address: 001d3f1ef827552ae1114027bd3ecf1f086ba0f9
Hash   : 23a69c1653e4ebbb619b0b2cb8a9bad49892a8b9...</pre>
</div>
</div>
<div class="paragraph data-line-581">
<p>Our address contains an alphabetic character d in the fourth position. The fourth character of the hash is 6, which is less than 8. So, we leave the d lowercase. The next alphabetic character in our address is f, in the sixth position. The sixth character of the hexadecimal hash is c, which is greater than 8. Therefore, we capitalize the F in the address, and so on. As you can see, we only use the first 20 bytes (40 hex characters) of the hash as a checksum, since we only have 20 bytes (40 hex characters) in the address to capitalize appropriately.</p>
</div>
<div class="paragraph data-line-583">
<p>Check the resulting mixed-capitals address yourself and see if you can tell which characters were capitalized and which characters they correspond to in the address hash:</p>
</div>
<div id="capitalize_output" class="listingblock data-line-586">
<div class="content">
<pre>Address: 001d3F1ef827552Ae1114027BD3ECF1f086bA0F9
Hash   : 23a69c1653e4ebbb619b0b2cb8a9bad49892a8b9...</pre>
</div>
</div>
<div class="sect4 data-line-592">
<h5 id="EIP55_error">Detecting an error in an EIP-55 encoded address</h5>
<div class="paragraph data-line-594">
<p>Now, let&#8217;s look at how EIP-55 addresses will help us find an error. Let&#8217;s assume we have printed out an Ethereum address, which is EIP-55 encoded:</p>
</div>
<div id="correct_address" class="listingblock data-line-597">
<div class="content">
<pre>0x001d3F1ef827552Ae1114027BD3ECF1f086bA0F9</pre>
</div>
</div>
<div class="paragraph data-line-601">
<p>Now let&#8217;s make a basic mistake in reading that address. The character before the last one is a capital F. For this example let&#8217;s assume we misread that as a capital E, and we type the following (incorrect) address into our wallet:</p>
</div>
<div id="incorrect_address" class="listingblock data-line-604">
<div class="content">
<pre>0x001d3F1ef827552Ae1114027BD3ECF1f086bA0E9</pre>
</div>
</div>
<div class="paragraph data-line-608">
<p>Fortunately, our wallet is EIP-55 compliant! It notices the mixed capitalization and attempts to validate the address. It converts it to lowercase, and calculates the checksum hash:</p>
</div>
<div id="hash_demo" class="listingblock data-line-611">
<div class="content">
<pre>Keccak256("001d3f1ef827552ae1114027bd3ecf1f086ba0e9") =
5429b5d9460122fb4b11af9cb88b7bb76d8928862e0a57d46dd18dd8e08a6927</pre>
</div>
</div>
<div class="paragraph data-line-616">
<p>As you can see, even though the address has only changed by one character (in fact, only one bit, as e and f are one bit apart), the hash of the address has changed radically. That&#8217;s the property of hash functions that makes them so useful for checksums!</p>
</div>
<div class="paragraph data-line-618">
<p>Now, let&#8217;s line up the two and check the capitalization:</p>
</div>
<div id="incorrect_capitalization" class="listingblock data-line-621">
<div class="content">
<pre>001d3F1ef827552Ae1114027BD3ECF1f086bA0E9
5429b5d9460122fb4b11af9cb88b7bb76d892886...</pre>
</div>
</div>
<div class="paragraph data-line-626">
<p>It&#8217;s all wrong! Several of the alphabetic characters are incorrectly capitalized. Remember that the capitalization is the encoding of the <em>correct</em> checksum.</p>
</div>
<div class="paragraph data-line-628">
<p>The capitalization of the address we input doesn&#8217;t match the checksum just calculated, meaning something has changed in the address, and an error has been <span class="keep-together">introduced</span>.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-632">
<h3 id="keys-addresses-conclusions">Conclusions</h3>
<div class="paragraph data-line-634">
<p>In this chapter we provided a brief survey of public key cryptography and focused on the use of public and private keys in Ethereum and the use of cryptographic tools, such as hash functions, in the creation and verification of Ethereum addresses. We also looked at digital signatures and how they can demonstrate ownership of a private key without revealing that private key. In <a href="#wallets_chapter">[wallets_chapter]</a>, we will put these ideas together and look at how wallets can be used to manage collections of keys.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-26 12:14:29 -0400
</div>
</div>
</body>
</html>