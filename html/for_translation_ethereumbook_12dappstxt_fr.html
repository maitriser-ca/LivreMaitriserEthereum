<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Applications décentralisées (DApps)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="decentralized_applications_chap">Applications décentralisées (DApps)</h2>
<div class="sectionbody">
<div class="paragraph data-line-4">
<p>In this chapter we will explore the world of <em>decentralized applications</em>, or <em>DApps</em>. From the early days of Ethereum, the founders' vision was much broader than "smart contracts": no less than reinventing the web and creating a new world of DApps, aptly called <em>web3</em>. Smart contracts are a way to decentralize the controlling logic and payment functions of applications. Web3 DApps are about decentralizing all other aspects of an application: storage, messaging, naming, etc. (see <a href="#image_web3_suite">Web3: A decentralized web using smart contracts and P2P technologies</a>).</p>
</div>
<div id="image_web3_suite" class="imageblock data-line-8">
<div class="content">
<img src="images/web3suite.png" alt="Web3: A decentralized web using smart contracts and P2P Technologies">
</div>
<div class="title">Figure 1. Web3: A decentralized web using smart contracts and P2P technologies</div>
</div>
<div class="admonitionblock warning data-line-11">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-12">
<p>While "decentralized apps" are an audacious vision of the future, the term "DApp" is often applied to any smart contract with a web frontend. Some of these so-called DApps are highly centralized applications (CApps?). Beware of false DApps!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-15">
<p>In this chapter we will develop and deploy a sample DApp: an auction platform. You can find the source code in the book&#8217;s repository under <a href="http://bit.ly/2DcmjyA" data-href="http://bit.ly/2DcmjyA"><em>code/auction_dapp</em></a>. We will look at each aspect of an auction application and see how we can decentralize the application as much as possible. First, though, let&#8217;s take a closer look at the defining characteristics and advantages of DApps.</p>
</div>
<div class="sect2 data-line-18">
<h3 id="what_is_a_dapp_sec">Qu&#8217;est-ce qu&#8217;une DApp?</h3>
<div class="paragraph data-line-20">
<p>A DApp is an application that is mostly or entirely decentralized.</p>
</div>
<div class="paragraph data-line-22">
<p>Consider all the possible aspects of an application that may be decentralized:</p>
</div>
<div class="ulist data-line-24">
<ul>
<li class="data-line-24">
<p>Backend software (application logic)</p>
</li>
<li class="data-line-25">
<p>Frontend software</p>
</li>
<li class="data-line-26">
<p>Data storage</p>
</li>
<li class="data-line-27">
<p>Message communications</p>
</li>
<li class="data-line-28">
<p>Name resolution</p>
</li>
</ul>
</div>
<div class="paragraph data-line-30">
<p>Each of these can be somewhat centralized or somewhat decentralized. For example, a frontend can be developed as a web app that runs on a centralized server, or as a mobile app that runs on your device. The backend and storage can be on private servers and proprietary databases, or you can use a smart contract and P2P storage.</p>
</div>
<div class="paragraph data-line-32">
<p>There are many advantages to creating a DApp that a typical centralized architecture cannot provide:</p>
</div>
<div class="dlist data-line-34">
<dl>
<dt class="hdlist1">Resiliency</dt>
<dd>
<p>Because the business logic is controlled by a smart contract, a DApp backend will be fully distributed and managed on a blockchain platform. Unlike an application deployed on a centralized server, a DApp will have no downtime and will continue to be available as long as the platform is still operating.</p>
</dd>
<dt class="hdlist1">Transparency</dt>
<dd>
<p>The on-chain nature of a DApp allows everyone to inspect the code and be more sure about its function. Any interaction with the DApp will be stored forever in the blockchain.</p>
</dd>
<dt class="hdlist1">Censorship resistance</dt>
<dd>
<p>As long as a user has access to an Ethereum node (running one if necessary), the user will always be able to interact with a DApp without interference from any centralized control. No service provider, or even the owner of the smart contract, can alter the code once it is deployed on the network.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-43">
<p>In the Ethereum ecosystem as it stands today, there are very few truly decentralized apps&#x2014;most still rely on centralized services and servers for some part of their operation. In the future, we expect that it will be possible for every part of any DApp to be operated in a fully decentralized way.</p>
</div>
<div class="sect3 data-line-46">
<h4 id="blockchain_smart_contracts_sec">Backend (contrat intelligent)</h4>
<div class="paragraph data-line-48">
<p>In a DApp, smart contracts are used to store the business logic (program code) and the related state of your application. You can think of a smart contract replacing a server-side (aka "backend") component in a regular application. This is an oversimplification, of course. One of the main differences is that any computation executed in a smart contract is very expensive and so should be kept as minimal as possible. It is therefore important to identify which aspects of the application need a trusted and decentralized execution platform.</p>
</div>
<div class="paragraph data-line-50">
<p>Ethereum smart contracts allow you to build architectures in which a network of smart contracts call and pass data between each other, reading and writing their own state variables as they go, with their complexity restricted only by the block gas limit. After you deploy your smart contract, your business logic could well be used by many other developers in the future.</p>
</div>
<div class="paragraph data-line-52">
<p>One major consideration of smart contract architecture design is the inability to change the code of a smart contract once it is deployed. It can be deleted if it is programmed with an accessible SELFDESTRUCT opcode, but other than complete removal, the code cannot be changed in any way.</p>
</div>
<div class="paragraph data-line-54">
<p>The second major consideration of smart contract architecture design is DApp size. A really large monolithic smart contract may cost a lot of gas to deploy and use. Therefore, some applications may choose to have off-chain computation and an external data source. Keep in mind, however, that having the core business logic of the DApp be dependent on external data (e.g., from a centralized server) means your users will have to trust these external resources.</p>
</div>
</div>
<div class="sect3 data-line-57">
<h4 id="front_end_web_ui_cec">Frontend (Interface utilisateur Web)</h4>
<div class="paragraph data-line-59">
<p>Unlike the business logic of the DApp, which requires a developer to understand the EVM and new languages such as Solidity, the client-side interface of a DApp can use standard web technologies (HTML, CSS, JavaScript, etc.). This allows a traditional web developer to use familiar tools, libraries, and frameworks. Interactions with Ethereum, such as signing messages, sending transactions, and managing keys, are often conducted through the web browser, via an extension such as MetaMask (see <a href="#intro_chapter">[intro_chapter]</a>).</p>
</div>
<div class="paragraph data-line-61">
<p>Although it is possible to create a mobile DApp as well, currently there are few resources to help create mobile DApp frontends, mainly due to the lack of mobile clients that can serve as a light client with key-management functionality.</p>
</div>
<div class="paragraph data-line-63">
<p>The frontend is usually linked to Ethereum via the <em>web3.js</em> JavaScript library, which is bundled with the frontend resources and served to a browser by a web server.</p>
</div>
</div>
<div class="sect3 data-line-66">
<h4 id="data_storage_sec">Stockage de données</h4>
<div class="paragraph data-line-68">
<p>Due to high gas costs and the currently low block gas limit, smart contracts are not well suited to storing or processing large amounts of data. Hence, most DApps utilize off-chain data storage services, meaning they store the bulky data off the Ethereum chain, on a data storage platform. That data storage platform can be centralized (for example, a typical cloud database), or the data can be decentralized, stored on a P2P platform such as the IPFS, or Ethereum&#8217;s own Swarm platform.</p>
</div>
<div class="paragraph data-line-70">
<p>Decentralized P2P storage is ideal for storing and distributing large static assets such as images, videos, and the resources of the application&#8217;s frontend web interface (HTML, CSS, JavaScript, etc.). We&#8217;ll look at a few of the options next.</p>
</div>
<div class="sect4 data-line-73">
<h5 id="ipfs_sec">IPFS</h5>
<div class="paragraph data-line-75">
<p>The <em>Inter-Planetary File System</em> (IPFS) is a decentralized content-addressable storage system that distributes stored objects among peers in a P2P network. "Content addressable" means that each piece of content (file) is hashed and the hash is used to identify that file. You can then retrieve any file from any IPFS node by requesting it by its hash.</p>
</div>
<div class="paragraph data-line-77">
<p>IPFS aims to replace HTTP as the protocol of choice for delivery of web applications. Instead of storing a web application on a single server, the files are stored on IPFS and can be retrieved from any IPFS node.</p>
</div>
<div class="paragraph data-line-79">
<p>More information about IPFS can be found at <a href="https://ipfs.io" class="undefined" data-href="https://ipfs.io">https://ipfs.io</a>.</p>
</div>
</div>
<div class="sect4 data-line-83">
<h5 id="swarm_sec">Swarm</h5>
<div class="paragraph data-line-85">
<p>Swarm is another content-addressable P2P storage system, similar to IPFS. Swarm was created by the Ethereum Foundation, as part of the Go-Ethereum suite of tools. Like IPFS, it allows you to store files that get disseminated and replicated by Swarm nodes. You can access any Swarm file by referring to it by a hash. Swarm allows you to access a website from a decentralized P2P system, instead of a central web server.</p>
</div>
<div class="paragraph data-line-87">
<p>The home page for Swarm is itself stored on Swarm and accessible on your Swarm node or a gateway:
<a href="https://swarm-gateways.net/bzz:/theswarm.eth/" class="undefined" data-href="https://swarm-gateways.net/bzz:/theswarm.eth/">https://swarm-gateways.net/bzz:/theswarm.eth/</a>.</p>
</div>
</div>
</div>
<div class="sect3 data-line-92">
<h4 id="interdapp_coammunications_protocol_sec">Protocoles de communication de messages décentralisés</h4>
<div class="paragraph data-line-94">
<p>Another major component of any application is inter-process communication. That means being able to exchange messages between applications, between different instances of the application, or between users of the application. Traditionally, this is achieved by reliance on a centralized server. However, there are a variety of decentralized alternatives to server-based protocols, offering messaging over a P2P network. The most notable P2P messaging protocol for DApps is <a href="http://bit.ly/2CSls5h" data-href="http://bit.ly/2CSls5h"><em>Whisper</em></a>, which is part of the Ethereum Foundation&#8217;s Go-Ethereum suite of tools.</p>
</div>
<div class="paragraph data-line-96">
<p>The final aspect of an application that can be decentralized is name resolution. We&#8217;ll take a close look at Ethereum&#8217;s name service later in this chapter; now, though, let&#8217;s dig into an example.</p>
</div>
</div>
</div>
<div class="sect2 data-line-99">
<h3 id="auction_dapp_intro">Un exemple basique de DApp: la DApp d&#8217;enchères</h3>
<div class="paragraph data-line-101">
<p>In this section we will start building an example DApp, to explore the various decentralization tools. Our DApp will implement a decentralized auction.</p>
</div>
<div class="paragraph data-line-103">
<p>The Auction DApp allows a user to register a "deed" token, which represents some unique asset, such as a house, a car, a trademark, etc. Once a token has been registered, the ownership of the token is transferred to the Auction DApp, allowing it to be listed for sale. The Auction DApp lists each of the registered tokens, allowing other users to place bids. During each auction, users can join a chat room created specifically for that auction. Once an auction is finalized, the deed token ownership is transferred to the winner of the auction.</p>
</div>
<div class="paragraph data-line-105">
<p>The overall auction process can be seen in <a href="#auction_dapp_overview">Auction DApp: A simple example auction DApp</a>.</p>
</div>
<div class="paragraph data-line-107">
<p>The main components of our Auction DApp are:</p>
</div>
<div class="ulist data-line-109">
<ul>
<li class="data-line-109">
<p>A smart contract implementing ERC721 non-fungible "deed" tokens (<code><span class="keep-together">DeedRepository</span></code>)</p>
</li>
<li class="data-line-110">
<p>A smart contract implementing an auction (AuctionRepository) to sell the deeds</p>
</li>
<li class="data-line-111">
<p>A web frontend using the Vue/Vuetify JavaScript framework</p>
</li>
<li class="data-line-112">
<p>The <em>web3.js</em> library to connect to Ethereum chains (via MetaMask or other clients)</p>
</li>
<li class="data-line-113">
<p>A Swarm client, to store resources such as images</p>
</li>
<li class="data-line-114">
<p>A Whisper client, to create per-auction chat rooms for all participants</p>
</li>
</ul>
</div>
<div id="auction_dapp_overview" class="imageblock data-line-118">
<div class="content">
<img src="images/auction_diagram.png" alt="Auction DApp: A simple example auction DApp">
</div>
<div class="title">Figure 2. Auction DApp: A simple example auction DApp</div>
</div>
<div class="paragraph data-line-120">
<p>You can find the source code for the auction DApp <a href="http://bit.ly/2DcmjyA" data-href="http://bit.ly/2DcmjyA">in the book&#8217;s repository</a>.</p>
</div>
<div class="sect3 data-line-123">
<h4 id="_dapp_denchères_smart_contracts_backend">DApp d&#8217;enchères: Smart contracts Backend</h4>
<div class="paragraph data-line-125">
<p>Our Auction DApp example is supported by two smart contracts that we need to deploy on an Ethereum blockchain in order to support the application: <code><span class="keep-together">AuctionRepository</span></code> and DeedRepository.</p>
</div>
<div class="paragraph data-line-127">
<p>Let&#8217;s start by looking at DeedRepository, shown in <a href="#deed_repository_code">DeedRepository.sol: An ERC721 deed token for use in an auction</a>. This contract is an ERC721-compatible non-fungible token (see <a href="#erc721">[erc721]</a>).</p>
</div>
<div id="deed_repository_code" class="exampleblock data-line-131">
<div class="title">Example 1. DeedRepository.sol: An ERC721 deed token for use in an auction</div>
<div class="content">
<div class="listingblock data-line-133">
<div class="content">
<pre class="highlight"><code class="language-solidity" data-lang="solidity">pragma solidity ^0.5.16;
import "./ERC721/ERC721Token.sol";

/**
 * @title Repository of ERC721 Deeds
 * This contract contains the list of deeds registered by users.
 * This is a demo to show how tokens (deeds) can be minted and added 
 * to the repository.
 */
contract DeedRepository is ERC721Token {


    /**
    * @dev Created a DeedRepository with a name and symbol
    * @param _name string represents the name of the repository
    * @param _symbol string represents the symbol of the repository
    */
    constructor(string memory _name, string memory _symbol) 
        public ERC721Token(_name, _symbol) {}
    
    /**
    * @dev Public function to register a new deed
    * @dev Call the ERC721Token minter
    * @param _tokenId uint256 represents a specific deed
    * @param _uri string containing metadata/uri
    */
    function registerDeed(uint256 _tokenId, string memory _uri) public {
        _mint(msg.sender, _tokenId);
        addDeedMetadata(_tokenId, _uri);
        emit DeedRegistered(msg.sender, _tokenId);
    }

    /**
    * @dev Public function to add metadata to a deed
    * @param _tokenId represents a specific deed
    * @param _uri text which describes the characteristics of a given deed
    * @return whether the deed metadata was added to the repository
    */
    function addDeedMetadata(uint256 _tokenId, string memory _uri) public returns(bool){
        _setTokenURI(_tokenId, _uri);
        return true;
    }

    /**
    * @dev Event is triggered if deed/token is registered
    * @param _by address of the registrar
    * @param _tokenId uint256 represents a specific deed
    */
    event DeedRegistered(address _by, uint256 _tokenId);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-138">
<p>As you can see, the DeedRepository contract is a straightforward implementation of an ERC721-compatible token.</p>
</div>
<div class="paragraph data-line-140">
<p>Our Auction DApp uses the DeedRepository contract to issue and track tokens for each auction. The auction itself is orchestrated by the AuctionRepository contract. This contract is too long to include here in full, but <a href="#auction_repository_code">AuctionRepository.sol: The main Auction DApp smart contract</a> shows the main definition of the contract and data structures. The entire contract is available in the book&#8217;s <a href="https://bit.ly/2IaOo9i" data-href="https://bit.ly/2IaOo9i">GitHub repository</a>.</p>
</div>
<div id="auction_repository_code" class="exampleblock data-line-144">
<div class="title">Example 2. AuctionRepository.sol: The main Auction DApp smart contract</div>
<div class="content">
<div class="listingblock data-line-146">
<div class="content">
<pre class="highlight"><code class="language-solidity" data-lang="solidity">contract AuctionRepository {

    // Array with all auctions
    Auction[] public auctions;

    // Mapping from auction index to user bids
    mapping(uint256 =&gt; Bid[]) public auctionBids;

    // Mapping from owner to a list of owned auctions
    mapping(address =&gt; uint[]) public auctionOwner;

    // Bid struct to hold bidder and amount
    struct Bid {
        address from;
        uint256 amount;
    }

    // Auction struct which holds all the required info
    struct Auction {
        string name;
        uint256 blockDeadline;
        uint256 startPrice;
        string metadata;
        uint256 deedId;
        address deedRepositoryAddress;
        address owner;
        bool active;
        bool finalized;
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-179">
<p>The AuctionRepository contract manages all auctions with the following functions:</p>
</div>
<div class="listingblock data-line-182">
<div class="content">
<pre class="highlight"><code class="language-solidity" data-lang="solidity">getCount()
getBidsCount(uint _auctionId)
getAuctionsOf(address _owner)
getCurrentBid(uint _auctionId)
getAuctionsCountOfOwner(address _owner)
getAuctionById(uint _auctionId)
createAuction(address _deedRepositoryAddress, uint256 _deedId,
              string _auctionTitle, string _metadata, uint256 _startPrice,
              uint _blockDeadline)
approveAndTransfer(address _from, address _to, address _deedRepositoryAddress,
                   uint256 _deedId)
cancelAuction(uint _auctionId)
finalizeAuction(uint _auctionId)
bidOnAuction(uint _auctionId)</code></pre>
</div>
</div>
<div class="paragraph data-line-199">
<p>You can deploy these contracts to the Ethereum blockchain of your choice (e.g., Ropsten) using truffle in the book&#8217;s repository:</p>
</div>
<pre data-type="programlisting">
$ <strong>cd code/auction_dapp/backend</strong>
$ <strong>truffle init</strong>
$ <strong>truffle compile</strong>
$ <strong>truffle migrate --network ropsten</strong>
</pre>
<div class="sect4 data-line-210">
<h5 id="_gouvernance_dapp">Gouvernance DApp</h5>
<div class="paragraph data-line-212">
<p>If you read through the two smart contracts of the Auction DApp you will notice something important: there is no special account or role that has special privileges over the DApp. Each auction has an owner with some special capabilities, but the Auction DApp itself has no privileged user.</p>
</div>
<div class="paragraph data-line-214">
<p>This is a deliberate choice to decentralize the governance of the DApp and relinquish any control once it has been deployed. Some DApps, by comparison, have one or more privileged accounts with special capabilities, such as the ability to terminate the DApp contract, to override or change its configuration, or to "veto" certain operations. Usually, these governance functions are introduced in the DApp in order to avoid unknown problems that might arise due to a bug.</p>
</div>
<div class="paragraph data-line-216">
<p>The issue of governance is a particularly difficult one to solve, as it represents a double-edged sword. On the one side, privileged accounts are dangerous; if compromised, they can subvert the security of the DApp. On the other side, without any privileged account, there are no recovery options if a bug is found. We have seen both of these risks manifest in Ethereum DApps. In the case of The DAO (<a href="#real_world_example_the_dao">[real_world_example_the_dao]</a> and <a href="#ethereum_fork_history">[ethereum_fork_history]</a>), there were some privileged accounts called the "curators," but they were very limited in their capabilities. Those accounts were not able to override the DAO attacker&#8217;s withdrawal of the funds. In a more recent case, the decentralized exchange Bancor experienced a massive theft because a privileged management account was compromised. Turns out, Bancor was not as decentralized as initially assumed.</p>
</div>
<div class="paragraph data-line-218">
<p>When building a DApp, you have to decide if you want to make the smart contracts truly independent, launching them and then having no control, or create privileged accounts and run the risk of those being compromised. Either choice carries risk, but in the long run, true DApps cannot have specialized access for privileged accounts&#x2014;that&#8217;s not decentralized.</p>
</div>
</div>
</div>
<div class="sect3 data-line-220">
<h4 id="_dapp_denchères_interface_utilisateur_frontend">DApp d&#8217;enchères : Interface utilisateur Frontend</h4>
<div class="paragraph data-line-222">
<p>Once the Auction DApp&#8217;s contracts are deployed, you can interact with them using your favorite JavaScript console and web3.js, or another web3 library. However, most users will need an easy-to-use interface. Our Auction DApp user interface is built using the Vue2/Vuetify JavaScript framework from Google.</p>
</div>
<div class="paragraph data-line-224">
<p>You can find the user interface code in the <em>code/auction_dapp/frontend</em> folder in <a href="https://github.com/ethereumbook/ethereumbook" data-href="https://github.com/ethereumbook/ethereumbook">the book&#8217;s repository</a>. The directory has the following structure and contents:</p>
</div>
<div class="listingblock data-line-226">
<div class="content">
<pre>frontend/
|-- build
|   |-- build.js
|   |-- check-versions.js
|   |-- logo.png
|   |-- utils.js
|   |-- vue-loader.conf.js
|   |-- webpack.base.conf.js
|   |-- webpack.dev.conf.js
|   `-- webpack.prod.conf.js
|-- config
|   |-- dev.env.js
|   |-- index.js
|   `-- prod.env.js
|-- index.html
|-- package.json
|-- package-lock.json
|-- README.md
|-- src
|   |-- App.vue
|   |-- components
|   |   |-- Auction.vue
|   |   `-- Home.vue
|   |-- config.js
|   |-- contracts
|   |   |-- AuctionRepository.json
|   |   `-- DeedRepository.json
|   |-- main.js
|   |-- models
|   |   |-- AuctionRepository.js
|   |   |-- ChatRoom.js
|   |   `-- DeedRepository.js
|   `-- router
|       `-- index.js</pre>
</div>
</div>
<div class="paragraph data-line-263">
<p>Once you have deployed the contracts, edit the frontend configuration in <em>frontend/src/config.js</em> and enter the addresses of the DeedRepository and AuctionRepository contracts, as deployed. The frontend application also needs access to an Ethereum node offering a JSON-RPC and WebSockets interface. Once you&#8217;ve configured the frontend, launch it with a web server on your local machine:</p>
</div>
<pre data-type="programlisting">
$ <strong>npm install</strong>
$ <strong>npm run dev</strong>
</pre>
<div class="paragraph data-line-272">
<p>The Auction DApp frontend will launch and will be accessible via any web browser at <a href="http://localhost:8080" class="undefined" data-href="http://localhost:8080">http://localhost:8080</a>.</p>
</div>
<div class="paragraph data-line-274">
<p>If all goes well you should see the screen shown in <a href="#auction_dapp_screen">Auction DApp user interface</a>, which illustrates the Auction DApp running in a web browser.</p>
</div>
<div id="auction_dapp_screen" class="imageblock data-line-278">
<div class="content">
<img src="images/auction_dapp_home_screen.png" alt="Auction DApp User interface">
</div>
<div class="title">Figure 3. Auction DApp user interface</div>
</div>
</div>
</div>
<div class="sect2 data-line-280">
<h3 id="_vers_une_plus_grande_décentralisation_de_la_dapp_denchères">Vers une plus grande décentralisation de la DApp d&#8217;enchères</h3>
<div class="paragraph data-line-282">
<p>Our DApp is already quite decentralized, but we can improve things.</p>
</div>
<div class="paragraph data-line-284">
<p>The AuctionRepository contract operates independently of any oversight, open to anyone. Once deployed it cannot be stopped, nor can any auction be controlled. Each auction has a separate chat room that allows anyone to communicate about the auction without censorship or identification. The various auction assets, such as the description and associated image, are stored on Swarm, making them hard to censor or block.</p>
</div>
<div class="paragraph data-line-286">
<p>Anyone can interact with the DApp by constructing transactions manually or by running the Vue frontend on their local machine. The DApp code itself is open source and developed collaboratively on a public repository.</p>
</div>
<div class="paragraph data-line-288">
<p>There are two things we can do to make this DApp decentralized and resilient:</p>
</div>
<div class="ulist data-line-290">
<ul>
<li class="data-line-290">
<p>Store all the application code on Swarm or IPFS.</p>
</li>
<li class="data-line-291">
<p>Access the DApp by reference to a name, using the Ethereum Name Service.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-293">
<p>We&#8217;ll explore the first option in the next section, and we&#8217;ll dig into the second in <a href="#ethereum_naming_system_ens">Le service de noms Ethereum (ENS)</a>.</p>
</div>
</div>
<div class="sect2 data-line-295">
<h3 id="_enregistrer_la_dapp_denchères_sur_swarm">Enregistrer la DApp d&#8217;enchères sur Swarm</h3>
<div class="paragraph data-line-297">
<p>We introduced Swarm in <a href="#swarm_sec">Swarm</a>, earlier in this chapter. Our Auction DApp already uses Swarm to store the icon image for each auction. This is a much more efficient solution than attempting to store data on Ethereum, which is expensive. It is also a lot more resilient than if these images were stored in a centralized service like a web server or file server.</p>
</div>
<div class="paragraph data-line-299">
<p>But we can take things one step further. We can store the entire frontend of the DApp itself in Swarm and run it from a Swarm node directly, instead of running a web server.</p>
</div>
<div class="sect3 data-line-301">
<h4 id="_préparation_de_swarm">Préparation de Swarm</h4>
<div class="paragraph data-line-303">
<p>To get started, you need to install Swarm and initialize your Swarm node. Swarm is part of the Ethereum Foundation&#8217;s Go-Ethereum suite of tools. Refer to the instructions for installing Go-Ethereum in <a href="#go_ethereum_geth">[go_ethereum_geth]</a>, or to install a Swarm binary release, follow the instructions in the <a href="http://bit.ly/2Q75KXw" data-href="http://bit.ly/2Q75KXw">Swarm documentation</a>.</p>
</div>
<div class="paragraph data-line-305">
<p>Once you have installed Swarm, you can check that it is working correctly by running it with the version command:</p>
</div>
<pre data-type="programlisting">
$ <strong>swarm version</strong>
Version: 0.3
Git Commit: 37685930d953bcbe023f9bc65b135a8d8b8f1488
Go Version: go1.10.1
OS: linux
</pre>
<div class="paragraph data-line-317">
<p>To start running Swarm, you must tell it how to connect to an instance of Geth, to access the JSON-RPC API. Get it started by following the instructions in the <a href="https://swarm-guide.readthedocs.io/en/latest/gettingstarted.html" data-href="https://swarm-guide.readthedocs.io/en/latest/gettingstarted.html">Getting Started guide</a>.</p>
</div>
<div class="paragraph data-line-319">
<p>When you start Swarm, you should see something like this:</p>
</div>
<div class="listingblock data-line-321">
<div class="content">
<pre>Maximum peer count                       ETH=25 LES=0 total=25
Starting peer-to-peer node               instance=swarm/v0.3.1-225171a4/linux...
connecting to ENS API                    url=http://127.0.0.1:8545
swarm[5955]: [189B blob data]
Starting P2P networking
UDP listener up                          self=enode://f50c8e19ff841bcd5ce7d2d...
Updated bzz local addr                   oaddr=9c40be8b83e648d50f40ad3... uaddr=e
Starting Swarm service
9c40be8b hive starting
detected an existing store. trying to load peers
hive 9c40be8b: peers loaded
Swarm network started on bzz address: 9c40be8b83e648d50f40ad3d35f...
Pss started
Streamer started
IPC endpoint opened                      url=/home/ubuntu/.ethereum/bzzd.ipc
RLPx listener up                         self=enode://f50c8e19ff841bcd5ce7d2d...</pre>
</div>
</div>
<div class="paragraph data-line-340">
<p>You can confirm that your Swarm node is running correctly by connecting to the local Swarm gateway web interface:
<a href="http://localhost:8500" class="undefined" data-href="http://localhost:8500">http://localhost:8500</a>.</p>
</div>
<div class="paragraph data-line-343">
<p>You should see a screen like the one in <a href="#image_swarm_gateway">Swarm gateway on localhost</a> and be able to query any Swarm hash or ENS name.</p>
</div>
<div id="image_swarm_gateway" class="imageblock data-line-347">
<div class="content">
<img src="images/swarm-gateway.png" alt="Swarm gateway on localhost">
</div>
<div class="title">Figure 4. Swarm gateway on localhost</div>
</div>
</div>
<div class="sect3 data-line-349">
<h4 id="_envoyer_des_fichiers_sur_swarm">Envoyer des fichiers sur Swarm</h4>
<div class="paragraph data-line-351">
<p>Once you have your local Swarm node and gateway running, you can upload to Swarm and the files will be accessible on any Swarm node, simply by reference to the file hash.</p>
</div>
<div class="paragraph data-line-353">
<p>Let&#8217;s test this by uploading a file:</p>
</div>
<pre data-type="programlisting">
$ <strong>swarm up code/auction_dapp/README.md</strong>
ec13042c83ffc2fb5cb0aa8c53f770d36c9b3b35d0468a0c0a77c97016bb8d7c
</pre>
<div class="paragraph data-line-362">
<p>Swarm has uploaded the <em>README.md</em> file and returned a hash that you can use to access the file from any Swarm node. For example, you could use the <a href="https://bit.ly/2znWUP9" data-href="https://bit.ly/2znWUP9">public Swarm gateway</a>.</p>
</div>
<div class="paragraph data-line-364">
<p>While uploading one file is relatively straightforward, it is a bit more complex to upload an entire DApp frontend. That&#8217;s because the various DApp resources (HTML, CSS, JavaScript, libraries, etc.) have embedded references to each other. Normally, a web server translates URLs to local files and serves the correct resources. We can achieve the same for Swarm by packaging our DApp.</p>
</div>
<div class="paragraph data-line-366">
<p>In the Auction DApp, there&#8217;s a script for packaging all the resources:</p>
</div>
<pre data-type="programlisting">
$ <strong>cd code/auction_dapp/frontend</strong>
$ <strong>npm run build</strong>

> <strong>frontend@1.0.0 build /home/aantonop/Dev/ethereumbook/code/auction_dapp/frontend</strong>
> <strong>node build/build.js</strong>

Hash: 9ee134d8db3c44dd574d
Version: webpack 3.10.0
Time: 25665ms
Asset     Size
static/js/vendor.77913f316aaf102cec11.js  1.25 MB
static/js/app.5396ead17892922422d4.js   502 kB
static/js/manifest.87447dd4f5e60a5f9652.js  1.54 kB
static/css/app.0e50d6a1d2b1ed4daa03d306ced779cc.css  1.13 kB
static/css/app.0e50d6a1d2b1ed4daa03d306ced779cc.css.map  2.54 kB
static/js/vendor.77913f316aaf102cec11.js.map  4.74 MB
static/js/app.5396ead17892922422d4.js.map   893 kB
static/js/manifest.87447dd4f5e60a5f9652.js.map  7.86 kB
index.html  1.15 kB

Build complete.
</pre>
<div class="paragraph data-line-394">
<p>The result of this command will be a new directory, <em>code/auction_dapp/frontend/dist</em>, that contains the entire Auction DApp frontend, packed together:</p>
</div>
<div class="listingblock data-line-396">
<div class="content">
<pre>dist/
|-- index.html
`-- static
    |-- css
    |   |-- app.0e50d6a1d2b1ed4daa03d306ced779cc.css
    |   `-- app.0e50d6a1d2b1ed4daa03d306ced779cc.css.map
    `-- js
        |-- app.5396ead17892922422d4.js
        |-- app.5396ead17892922422d4.js.map
        |-- manifest.87447dd4f5e60a5f9652.js
        |-- manifest.87447dd4f5e60a5f9652.js.map
        |-- vendor.77913f316aaf102cec11.js
        `-- vendor.77913f316aaf102cec11.js.map</pre>
</div>
</div>
<div class="paragraph data-line-413">
<p>Now you can upload the entire DApp to Swarm, by using the up command and the --recursive option. Here, we also tell Swarm that index.html is the defaultpath for loading this DApp:</p>
</div>
<pre data-type="programlisting">
$ <strong>swarm --bzzapi http://localhost:8500 --recursive \
  --defaultpath dist/index.html up dist/</strong>

ab164cf37dc10647e43a233486cdeffa8334b026e32a480dd9cbd020c12d4581
</pre>
<div class="paragraph data-line-424">
<p>Now, our entire Auction DApp is hosted on Swarm and accessible by the Swarm URL:</p>
</div>
<ul class="simplelist">
<li><em>bzz://ab164cf37dc10647e43a233486cdeffa8334b026e32a480dd9cbd020c12d4581</em></li>
</ul>
<div class="paragraph data-line-432">
<p>We&#8217;ve made some progress in decentralizing our DApp, but we&#8217;ve made it harder to use. A URL like that is much less user-friendly than a nice name like <em>auction_dapp.com</em>. Are we forced to sacrifice usability in order to gain decentralization? Not necessarily. In the next section we will examine Ethereum&#8217;s name service, which allows us to use easy-to-read names but still preserves the decentralized nature of our application.</p>
</div>
</div>
</div>
<div class="sect2 data-line-435">
<h3 id="ethereum_naming_system_ens">Le service de noms Ethereum (ENS)</h3>
<div class="paragraph data-line-437">
<p>You can design the best smart contract in the world, but if you don&#8217;t provide a good interface for users, they won&#8217;t be able to access it.</p>
</div>
<div class="paragraph data-line-439">
<p>On the traditional internet, the Domain Name System (DNS) allows us to use human-readable names in the browser while resolving those names to IP addresses or other identifiers behind the scenes. On the Ethereum blockchain, the <em>Ethereum Naming System</em> (ENS) solves the same problem, but in a decentralized manner.</p>
</div>
<div class="paragraph data-line-441">
<p>For example, the Ethereum Foundation donation address is 0xfB6916095ca1df60bB79Ce92cE3Ea74c37c5d359; in a wallet that supports ENS, it&#8217;s simply ethereum.eth.</p>
</div>
<div class="paragraph data-line-443">
<p>ENS is more than a smart contract; it&#8217;s a fundamental DApp itself, offering a decentralized name service. Furthermore, ENS is supported by a number of DApps for registration, management, and auctions of registered names. ENS demonstrates how DApps can work together: it&#8217;s DApp built to serve other DApps, supported by an ecosystem of DApps, embedded in other DApps, and so on.</p>
</div>
<div class="paragraph data-line-445">
<p>In this section we will look at how ENS works. We&#8217;ll demonstrate how you can set up your own name and link it to a wallet or Ethereum address, how you can embed ENS in another DApp, and how you can use ENS to name your DApp resources to make them easier to use.</p>
</div>
<div class="sect3 data-line-447">
<h4 id="_historique_des_services_de_noms_ethereum">Historique des services de noms Ethereum</h4>
<div class="paragraph data-line-449">
<p>Name registration was the first noncurrency application of blockchains, pioneered by Namecoin. The Ethereum <a href="http://bit.ly/2Of1gfZ" data-href="http://bit.ly/2Of1gfZ">White Paper</a> gave a two-line Namecoin-like registration system as one of its example applications.</p>
</div>
<div class="paragraph data-line-451">
<p>Early releases of Geth and the C++ Ethereum client had a built-in namereg contract (not used any more), and many proposals and ERCs for name services were made, but it was only when Nick Johnson started working for the Ethereum Foundation in 2016 and took the project under his wing that serious work on a registrar started.</p>
</div>
<div class="paragraph data-line-453">
<p>ENS was launched on Star Wars Day, May 4, 2017 (after a failed attempt to launch it on Pi Day, March 15).</p>
</div>
</div>
<div class="sect3 data-line-455">
<h4 id="_la_spécification_ens">La spécification ENS</h4>
<div class="paragraph data-line-457">
<p>ENS is specified mainly in three Ethereum Improvement Proposals: EIP-137, which specifies the basic functions of ENS; EIP-162, which describes the auction system for the .eth root; and EIP-181, which specifies reverse resolution of addresses.</p>
</div>
<div class="paragraph data-line-459">
<p>ENS follows a "sandwich" design philosophy: a very simple layer on the bottom, followed by layers of more complex but replaceable code, with a very simple top layer that keeps all the funds in separate accounts.</p>
</div>
</div>
<div class="sect3 data-line-461">
<h4 id="_couche_inférieure_propriétaires_de_noms_et_résolveurs">Couche inférieure: propriétaires de noms et résolveurs</h4>
<div class="paragraph data-line-463">
<p>The ENS operates on "nodes" instead of human-readable names: a human-readable name is converted to a node using the "Namehash" algorithm.</p>
</div>
<div class="paragraph data-line-465">
<p>The base layer of ENS is a cleverly simple contract (less than 50 lines of code) defined by ERC137 that allows only nodes' owners to set information about their names and to create subnodes (the ENS equivalent of DNS subdomains).</p>
</div>
<div class="paragraph data-line-467">
<p>The only functions on the base layer are those that enable a node owner to set information about their own node (specifically the resolver, time to live, or transferring the ownership) and to create owners of new subnodes.</p>
</div>
<div class="sect4 data-line-469">
<h5 id="_lalgorithme_namehash">L&#8217;algorithme Namehash</h5>
<div class="paragraph data-line-471">
<p>Namehash is a recursive algorithm that can convert any name into a hash that identifies the name.</p>
</div>
<div class="paragraph data-line-473">
<p>"Recursive" means that we solve the problem by solving a subproblem that is a smaller problem of the same type, and then use the solution to the subproblem to solve the original problem.</p>
</div>
<div class="paragraph data-line-475">
<p>Namehash recursively hashes components of the name, producing a unique, fixed-length string (or &#x201c;node&#x201d;) for any valid input domain. For example, the Namehash node of subdomain.example.eth is <code>keccak('&lt;example.eth&gt;' node) + keccak('&lt;subdomain&gt;')</code>. The subproblem we must solve is to compute the node for example.eth, which is <code>keccak('&lt;.eth&gt;' node) + keccak('&lt;example&gt;')</code>.  To begin, we must compute the node for eth, which is <code>keccak(&lt;root node&gt;) + keccak('&lt;eth&gt;')</code>.</p>
</div>
<div class="paragraph data-line-477">
<p>The root node is what we call the "base case" of our recursion, and we obviously can&#8217;t define it recursively, or the algorithm will never terminate! The root node is defined as <code>0x0000000000000000000000000000000000000000000000000000000000000000</code> (32 zero bytes).</p>
</div>
<div class="paragraph data-line-479">
<p>Putting this all together, the node of subdomain.example.eth is therefore <code><span class="keep-together">keccak</span>(keccak(keccak(0x0...0 + keccak('eth')) + keccak('example')) + keccak('subdomain'))</code>.</p>
</div>
<div class="paragraph data-line-481">
<p>Generalizing, we can define the Namehash function as follows (the base case for the root node, or empty name, followed by the recursive step):</p>
</div>
<div class="literalblock data-line-483">
<div class="content">
<pre>namehash([]) = 0x0000000000000000000000000000000000000000000000000000000000000000
namehash([label, ...]) = keccak256(namehash(...) + keccak256(label))</pre>
</div>
</div>
<div class="paragraph data-line-488">
<p>In Python this becomes:</p>
</div>
<div class="literalblock data-line-490">
<div class="content">
<pre>def namehash(name):
  if name == '':
    return '\0' * 32
  else:
    label, _, remainder = name.partition('.')
    return sha3(namehash(remainder) + sha3(label))</pre>
</div>
</div>
<div class="paragraph data-line-499">
<p>Thus, mastering-ethereum.eth will be processed as follows:</p>
</div>
<div class="literalblock data-line-501">
<div class="content">
<pre>namehash('mastering-ethereum.eth')
⇒ sha3(namehash('eth') + sha3('mastering-ethereum'))
⇒ sha3(sha3(namehash('') + sha3('eth')) + sha3('mastering-ethereum'))
⇒ sha3(sha3(('\0' * 32) + sha3('eth')) + sha3('mastering-ethereum'))</pre>
</div>
</div>
<div class="paragraph data-line-508">
<p>Of course, subdomains can themselves have subdomains: there could be a sub.subdomain.example.eth after subdomain.example.eth, then a sub.sub.subdomain.example.eth, and so on. To avoid expensive recomputation, since Namehash depends only on the name itself, the node for a given name can be precomputed and inserted into a contract, removing the need for string manipulation and permitting immediate lookup of ENS records regardless of the number of components in the raw name.</p>
</div>
</div>
<div class="sect4 data-line-510">
<h5 id="_comment_choisir_un_nom_valide">Comment choisir un nom valide</h5>
<div class="paragraph data-line-511">
<p>Names consist of a series of dot-separated labels. Although upper- and lowercase letters are allowed, all labels should follow a UTS &#x23;46 normalization process that case-folds labels before hashing them, so names with different case but identical spelling will end up with the same Namehash.</p>
</div>
<div class="paragraph data-line-513">
<p>You could use labels and domains of any length, but for the sake of compatibility with legacy DNS, the following rules are recommended:</p>
</div>
<div class="ulist data-line-515">
<ul>
<li class="data-line-515">
<p>Labels should be no more than 64 characters each.</p>
</li>
<li class="data-line-516">
<p>Complete ENS names should be no more than 255 characters.</p>
</li>
<li class="data-line-517">
<p>Labels should not start or end with hyphens, or start with digits.</p>
</li>
</ul>
</div>
</div>
<div class="sect4 data-line-519">
<h5 id="_propriété_du_nœud_racine">Propriété du nœud racine</h5>
<div class="paragraph data-line-521">
<p>One of the results of this hierarchical system is that it relies on the owners of the root node, who are able to create top-level domains (TLDs).</p>
</div>
<div class="paragraph data-line-523">
<p>While the eventual goal is to adopt a decentralized decision-making process for new TLDs, at the time of writing the root node is controlled by a 4-of-7 multisig, held by people in different countries (built as a reflection of the 7 keyholders of the DNS system).
As a result, a majority of at least 4 of the 7 keyholders is required to effect any change.</p>
</div>
<div class="paragraph data-line-526">
<p>Currently the purpose and goal of these keyholders is to work in consensus with the community to:</p>
</div>
<div class="ulist data-line-528">
<ul>
<li class="data-line-528">
<p>Migrate and upgrade the temporary ownership of the .eth TLD to a more permanent contract once the system is evaluated.</p>
</li>
<li class="data-line-529">
<p>Allow adding new TLDs, if the community agrees they are needed.</p>
</li>
<li class="data-line-530">
<p>Migrate the ownership of the root multisig to a more decentralized contract, when such a system is agreed upon, tested, and implemented.</p>
</li>
<li class="data-line-531">
<p>Serve as a last-resort way to deal with any bugs or vulnerabilities in the top-level registries.</p>
</li>
</ul>
</div>
</div>
<div class="sect4 data-line-533">
<h5 id="_résolveurs">Résolveurs</h5>
<div class="paragraph data-line-535">
<p>The basic ENS contract can&#8217;t add metadata to names; that is the job of so-called "resolver contracts." These are user-created contracts that can answer questions about the name, such as what Swarm address is associated with the app, what address receives payments to the app (in ether or tokens), or what the hash of the app is (to verify its integrity).</p>
</div>
</div>
</div>
<div class="sect3 data-line-537">
<h4 id="_couche_intermédiaire_les_nœuds_eth">Couche intermédiaire: les nœuds .eth</h4>
<div class="paragraph data-line-539">
<p>At the time of writing, the only top-level domain that is uniquely registrable in a smart contract is .eth.</p>
</div>
<div class="admonitionblock note data-line-542">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-543">
<p>There&#8217;s work underway on enabling traditional DNS domain owners to claim ENS ownership.
While in theory this could work for .com, the only domain that this has been implemented for so far is <a href="http://bit.ly/2SwUuFC" data-href="http://bit.ly/2SwUuFC">.xyz, and only on the Ropsten testnet</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-547">
<p>.eth domains are distributed via an auction system. There is no reserved list or priority, and the only way to acquire a name is to use the system. The auction system is a complex piece of code (over 500 lines); most of the early development efforts (and bugs!) in ENS were in this part of the system. However, it&#8217;s also replaceable and upgradeable, without risk to the funds—more on that later.</p>
</div>
<div class="sect4 data-line-550">
<h5 id="vickrey_auction">Enchères Vickrey</h5>
<div class="paragraph data-line-552">
<p>Names are distributed via a modified Vickrey auction. In a traditional Vickrey auction, every bidder submits a sealed bid, and all of them are revealed simultaneously, at which point the highest bidder wins the auction but only pays the second-highest bid. Therefore bidders are incentivized not to bid less than the true value of the name to them, since bidding their true value increases the chance they will win but does not affect the price they will eventually pay.</p>
</div>
<div class="paragraph data-line-554">
<p>On a blockchain, some changes are required:</p>
</div>
<div class="ulist data-line-556">
<ul>
<li class="data-line-556">
<p>To ensure bidders don&#8217;t submit bids they have no intention of paying, they must lock up a value equal to or higher than their bid beforehand, to guarantee the bid is valid.</p>
</li>
<li class="data-line-557">
<p>Because you can&#8217;t hide secrets on a blockchain, bidders must execute at least two transactions (a commit–reveal process), in order to hide the original value and name they bid on.</p>
</li>
<li class="data-line-558">
<p>Since you can&#8217;t reveal all bids simultaneously in a decentralized system, bidders must reveal their own bids themselves; if they don&#8217;t, they forfeit their locked-up funds. Without this forfeit, one could make many bids and choose to reveal only one or two, turning a sealed-bid auction into a traditional increasing price <span class="keep-together">auction</span>.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-560">
<p>Therefore, the auction is a four-step process:</p>
</div>
<div class="olist arabic data-line-562">
<ol class="arabic">
<li class="data-line-562">
<p>Start the auction. This is required to broadcast the intent to register a name.
This creates all auction deadlines. The names are hashed, so that only those who have the name in their dictionary will know which auction was opened. This allows some privacy, which is useful if you are creating a new project and don&#8217;t want to share details about it.
You can open multiple dummy auctions at the same time, so if someone is following you they cannot simply bid on all auctions you open.</p>
</li>
<li class="data-line-566">
<p>Make a sealed bid. You must do this before the bidding deadline, by tying a given amount of ether to the hash of a secret message (containing, among other things, the hash of the name, the actual amount of the bid, and a salt).
You can lock up more ether than you are actually bidding in order to mask your true valuation.</p>
</li>
<li class="data-line-569">
<p>Reveal the bid. During the reveal period, you must make a transaction that reveals the bid, which will then calculate the highest bid and the second-highest bid and send ether back to unsuccessful bidders.
Every time the bid is revealed the current winner is recalculated; therefore, the last one to be set before the revealing deadline expires becomes the overall winner.</p>
</li>
<li class="data-line-572">
<p>Clean up after. If you are the winner, you can finalize the auction in order to get back the difference between your bid and the second-highest bid.
If you forgot to reveal you can make a late reveal and recover a little of your bid.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3 data-line-575">
<h4 id="_couche_supérieure_les_actes">Couche supérieure: les actes</h4>
<div class="paragraph data-line-577">
<p>The top layer of ENS is yet another super-simple contract with a single purpose: to hold the funds.</p>
</div>
<div class="paragraph data-line-579">
<p>When you win a name, the funds are not actually sent anywhere, but are just locked up for the period you want to hold the name (at least a year).
This works like a guaranteed buyback: if the owner does not want the name any more they can sell it back to the system and recover their ether (so the cost of holding the name is the opportunity cost of doing something with a return greater than zero).</p>
</div>
<div class="paragraph data-line-582">
<p>Of course, having a single contract hold millions of dollars in ether has proven to be very risky, so instead ENS creates a deed contract for each new name.
The deed contract is very simple (about 50 lines of code), and it only allows the funds to be transferred back to a single account (the deed owner) and to be called by a single entity (the registrar contract).
This approach drastically reduces the attack surface where bugs can put the funds at risk.</p>
</div>
</div>
<div class="sect3 data-line-586">
<h4 id="_enregistrement_dun_nom">Enregistrement d&#8217;un nom</h4>
<div class="paragraph data-line-588">
<p>Registering a name in ENS is a four-step process, as we saw in  <a href="#vickrey_auction">Enchères Vickrey</a>. First we place a bid for any available name, then we reveal our bid after 48 hours to secure the name. <a href="#ens_registration_timeline">ENS timeline for registration</a> is a diagram showing the timeline of registration.</p>
</div>
<div class="paragraph data-line-590">
<p>Let&#8217;s register our first name!</p>
</div>
<div class="paragraph data-line-592">
<p>We will use one of several available user-friendly interfaces to search for available names, place a bid on the name ethereumbook.eth, reveal the bid, and secure the name.</p>
</div>
<div class="paragraph data-line-594">
<p>There are a number of web-based interfaces to ENS that allow us to interact with the ENS DApp. For this example, we will use the <a href="https://mycrypto.com/" data-href="https://mycrypto.com/">MyCrypto interface</a>, in conjunction with MetaMask as our wallet.</p>
</div>
<div id="ens_registration_timeline" class="imageblock data-line-598">
<div class="content">
<img src="images/ens-flow.png" alt="ens flow">
</div>
<div class="title">Figure 5. ENS timeline for registration</div>
</div>
<div class="paragraph data-line-602">
<p>First, we need to make sure the name we want is available. While writing this book, we really wanted to register the name mastering.eth, but alas, <a href="#ens-name-search">Searching for ENS names on MyCrypto.com</a> revealed it was already taken! Because ENS registrations only last one year, it might become possible to secure that name in the future. In the meantime, let&#8217;s search for ethereumbook.eth (<a href="#ens-name-search">Searching for ENS names on MyCrypto.com</a>).</p>
</div>
<div id="ens-name-search" class="imageblock data-line-606">
<div class="content">
<img src="images/ens-checkname.png" alt="Searching for ENS names on MyCrypto.com">
</div>
<div class="title">Figure 6. Searching for ENS names on MyCrypto.com</div>
</div>
<div class="paragraph data-line-608">
<p>Great! The name is available. In order to register it, we need to move forward with <a href="#ens-auction">Starting an auction for an ENS name</a>. Let&#8217;s unlock MetaMask and start an auction for ethereumbook.eth.</p>
</div>
<div id="ens-auction" class="imageblock data-line-613">
<div class="content">
<img src="images/ens-auction.png" alt="Starting an auction for an ENS name">
</div>
<div class="title">Figure 7. Starting an auction for an ENS name</div>
</div>
<div class="paragraph data-line-616">
<p>Let&#8217;s make our bid. In order to do that we need to follow the steps in <a href="#ens-bid">Placing a bid for an ENS name</a>.</p>
</div>
<div id="ens-bid" class="imageblock data-line-621">
<div class="content">
<img src="images/ens-bid.png" alt="Placing a bid for an ENS name">
</div>
<div class="title">Figure 8. Placing a bid for an ENS name</div>
</div>
<div class="admonitionblock warning data-line-624">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-625">
<p>As mentioned in <a href="#vickrey_auction">Enchères Vickrey</a>, you must reveal your bid within 48 hours after the auction is complete, or you <em>lose the funds in your bid</em>. Did we forget to do this and lose 0.01 ETH ourselves? You bet we did.</p>
</div>
<div class="paragraph data-line-627">
<p>Take a screenshot, save your secret phrase (as a backup for your bid), and add a reminder in your calendar for the reveal date and time, so you don&#8217;t forget and lose your funds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-630">
<p>Finally, we confirm the transaction by clicking the big green submit button shown in <a href="#ens-metamask-bid">MetaMask transaction containing your bid</a>.</p>
</div>
<div id="ens-metamask-bid" class="imageblock data-line-634">
<div class="content">
<img src="images/ens-metamask-bid.png" alt="MetaMask transaction containing your bid">
</div>
<div class="title">Figure 9. MetaMask transaction containing your bid</div>
</div>
<div class="paragraph data-line-636">
<p>If all goes well, after submitting a transaction in this way you can return and reveal the bid in 48 hours, and the name you requested will be registered to your Ethereum address.</p>
</div>
</div>
<div class="sect3 data-line-638">
<h4 id="_gérer_votre_nom_ens">Gérer votre nom ENS</h4>
<div class="paragraph data-line-640">
<p>Once you have registered an ENS name, you can manage it using another user-friendly interface: <a href="https://manager.ens.domains/" data-href="https://manager.ens.domains/">ENS Manager</a>.</p>
</div>
<div class="paragraph data-line-643">
<p>Once there, enter the name you want to manage in the search box (see <a href="#ens-manager">The ENS Manager web interface</a>). You need to have your Ethereum wallet  (e.g., MetaMask) unlocked, so that the ENS Manager DApp can manage the name on your behalf.</p>
</div>
<div id="ens-manager" class="imageblock data-line-647">
<div class="content">
<img src="images/ens-manager.png" alt="The ENS Manager web interface">
</div>
<div class="title">Figure 10. The ENS Manager web interface</div>
</div>
<div class="paragraph data-line-649">
<p>From this interface, we can create subdomains, set a resolver contract (more on that later), and connect each name to the appropriate resource, such as the Swarm address of a DApp frontend.</p>
</div>
<div class="sect4 data-line-651">
<h5 id="_création_dun_sous_domaine_ens">Création d&#8217;un sous-domaine ENS</h5>
<div class="paragraph data-line-653">
<p>First, let&#8217;s create a subdomain for our example Auction DApp (see <a href="#ens-manager-add-subdomain">Adding the subdomain auction.ethereumbook.eth</a>). We will name the subdomain auction, so the fully qualified name will be auction.ethereumbook.eth.</p>
</div>
<div id="ens-manager-add-subdomain" class="imageblock data-line-657">
<div class="content">
<img src="images/ens_manager_add_subdomain.png" alt="Adding the subdomain auction.ethereumbook.eth">
</div>
<div class="title">Figure 11. Adding the subdomain auction.ethereumbook.eth</div>
</div>
<div class="paragraph data-line-659">
<p>Once we&#8217;ve created the subdomain, we can enter auction.ethereumbook.eth in the search box and manage it, just as we managed the domain ethereumbook.eth <span class="keep-together">previously</span>.</p>
</div>
</div>
</div>
<div class="sect3 pagebreak-before data-line-662">
<h4 id="_résolveurs_ens">Résolveurs ENS</h4>
<div class="paragraph data-line-664">
<p>In ENS, resolving a name is a two-step process:</p>
</div>
<div class="olist arabic data-line-666">
<ol class="arabic">
<li class="data-line-666">
<p>The ENS registry is called with the name to resolve after hashing it.
If the record exists, the registry returns the address of its resolver.</p>
</li>
<li class="data-line-669">
<p>The resolver is called, using the method appropriate to the resource being requested. The resolver returns the desired result.</p>
</li>
</ol>
</div>
<div class="paragraph data-line-671">
<p>This two-step process has several benefits. Separating the functionality of resolvers from the naming system itself gives us a lot more flexibility. The owners of names can use custom resolvers to resolve any type or resource, extending the functionality of ENS. For example, if in the future you wanted to link a geolocation resource (longitude/lattitude) to an ENS name, you could create a new resolver that answers a <span class="keep-together"><code>geolocation</code></span> query. Who knows what applications might be useful in the future? With custom resolvers, the only limitation is your imagination.</p>
</div>
<div class="paragraph data-line-673">
<p>For convenience, there is a default public resolver that can resolve a variety of resources, including the address (for wallets or contracts) and content (a Swarm hash for DApps or contract source code).</p>
</div>
<div class="paragraph data-line-675">
<p>Since we want to link our Auction DApp to a Swarm hash, we can use the public resolver, which supports content resolution, as shown in <a href="#ens-manager-set-default-resolver">Setting the default public resolver for auction.ethereumbook.eth</a>; we don&#8217;t need to code or deploy a custom resolver.</p>
</div>
<div id="ens-manager-set-default-resolver" class="imageblock data-line-679">
<div class="content">
<img src="images/ens-manager-set-default-resolver.png" alt="Set the default public resolver for auction.ethereumbook.eth">
</div>
<div class="title">Figure 12. Setting the default public resolver for auction.ethereumbook.eth</div>
</div>
</div>
<div class="sect3 data-line-681">
<h4 id="_résolution_dun_nom_en_hachage_swarm_contenu">Résolution d&#8217;un nom en hachage Swarm (contenu)</h4>
<div class="paragraph data-line-683">
<p>Once the resolver for auction.ethereumbook.eth is set to be the public resolver, we can set it to return the Swarm hash as the content of our name (see <a href="#ens-set-content">Setting the 'content' to return for auction.ethereumbook.eth</a>).</p>
</div>
<div id="ens-set-content" class="imageblock data-line-687">
<div class="content">
<img src="images/ens-manager-set-content.png" alt="Set the 'content' return for auction.ethereumbook.eth">
</div>
<div class="title">Figure 13. Setting the 'content' to return for auction.ethereumbook.eth</div>
</div>
<div class="paragraph data-line-689">
<p>After waiting a short time for our transaction to be confirmed, we should be able to resolve the name correctly. Before setting a name, our Auction DApp could be found on a Swarm gateway by its hash:</p>
</div>
<ul class="simplelist">
<li><em>https://swarm-gateways.net/bzz:/ab164cf37dc10647e43a233486cdeffa8334b026e32a480dd9cbd020c12d4581</em></li>
</ul>
<div class="paragraph data-line-697">
<p>or by searching in a DApp browser or Swarm gateway for the Swarm URL:</p>
</div>
<ul class="simplelist">
<li><em>bzz://ab164cf37dc10647e43a233486cdeffa8334b026e32a480dd9cbd020c12d4581</em></li>
</ul>
<div class="paragraph pagebreak-before data-line-706">
<p>Now that we have attached it to a name, it is much easier:</p>
</div>
<ul class="simplelist">
<li><em>http://swarm-gateways.net/bzz:/auction.ethereumbook.eth/</em></li>
</ul>
<div class="paragraph data-line-714">
<p>We can also find it by searching for "auction.ethereumbook.eth" in any ENS-compatible wallet or DApp browser (e.g., Mist).</p>
</div>
</div>
</div>
<div class="sect2 data-line-716">
<h3 id="_de_lapp_vers_la_dapp">De l&#8217;App vers la DApp</h3>
<div class="paragraph data-line-718">
<p>Over the past several sections, we have gradually built a decentralized application. We started with a pair of smart contracts to run an auction for ERC721 deeds. These contracts were designed to have no governing or privileged accounts, so that their operation is truly decentralized. We  added a frontend, implemented in JavaScript, that offers a convenient and user-friendly interface to our DApp. The auction DApp uses the decentralized storage system Swarm to store application resources such as images. The DApp also uses the decentralized communications protocol Whisper to offer an encrypted chat room for each auction, without any central servers.</p>
</div>
<div class="paragraph data-line-720">
<p>We uploaded the entire frontend to Swarm, so that our DApp doesn&#8217;t rely on any web servers to serve the files. Finally, we allocated a name for our DApp using ENS, connecting it to the Swarm hash of the frontend, so that users can access it with a simple and easy-to-remember human-readable name.</p>
</div>
<div class="paragraph data-line-722">
<p>With each of these steps, we increased the decentralization of our application. The final result is a DApp that has no central point of authority, no central point of failure, and expresses the "web3" vision.</p>
</div>
<div class="paragraph data-line-724">
<p><a href="#auction_dapp_final_architecture">Auction DApp architecture</a> shows the complete architecture of the Auction DApp.</p>
</div>
<div id="auction_dapp_final_architecture" class="imageblock data-line-728">
<div class="content">
<img src="images/auction_dapp_final_architecture.png" alt="Auction DApp architecture">
</div>
<div class="title">Figure 14. Auction DApp architecture</div>
</div>
</div>
<div class="sect2 data-line-730">
<h3 id="_conclusions">Conclusions</h3>
<div class="paragraph data-line-732">
<p>Decentralized applications are the culmination of the Ethereum vision, as expressed by the founders from the very earliest designs. While a lot of applications call themselves "DApps" today, most are not fully decentralized. However, it is already possible to construct applications that are almost completely decentralized. Over time, as the technology matures further, more and more of our applications can be decentralized, resulting in a more resilient, censorship-resistant, and free web.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-26 01:03:04 -0400
</div>
</div>
</body>
</html>