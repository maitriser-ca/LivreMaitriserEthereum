<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Transactions</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="tx_chapter">Transactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les transactions sont des messages signés provenant d&#39;un compte externe, transmis par le réseau Ethereum et enregistrés sur la chaîne de blocs Ethereum. Cette définition de base cache bien des détails surprenants et fascinants. Une autre façon de voir les transactions est qu&#39;elles sont les seules choses qui peuvent déclencher un changement d&#39;état ou provoquer l&#39;exécution d&#39;un contrat dans l&#39;EVM. Ethereum est une machine à états singleton globale, et les transactions sont ce qui fait que cette machine à états &quot;fonctionner&quot;, qui change son état. Les contrats ne fonctionnent pas seuls. Ethereum ne fonctionne pas de manière autonome. Tout commence par une transaction.</p>
</div>
<div class="paragraph">
<p>Dans ce chapitre, nous allons disséquer les transactions, montrer leur fonctionnement et examiner les détails. Notez qu&#39;une grande partie de ce chapitre s&#39;adresse à ceux qui souhaitent gérer leurs propres transactions à un niveau inférieur, peut-être parce qu&#39;ils écrivent une application de portefeuille ; vous n&#39;avez pas à vous en soucier si vous êtes satisfait des applications de portefeuille existantes, bien que vous puissiez trouver les détails intéressants !</p>
</div>
<div class="sect2">
<h3 id="tx_struct">La structure d&#39;une transaction</h3>
<div class="paragraph">
<p>Regardons d&#39;abord la structure de base d&#39;une transaction, telle qu&#39;elle est sérialisée et transmise sur le réseau Ethereum. Chaque client et application qui reçoit une transaction sérialisée la stocke en mémoire en utilisant sa propre structure de données interne, éventuellement agrémentée de métadonnées qui n&#39;existent pas dans la transaction sérialisée du réseau elle-même. La sérialisation réseau est la seule forme standard d&#39;une transaction.</p>
</div>
<div class="paragraph">
<p>Une transaction est un message binaire sérialisé qui contient les données suivantes :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Nonce</dt>
<dd>
<p>Un numéro de séquence, émis par l&#39;EOA d&#39;origine, utilisé pour empêcher la relecture du message</p>
</dd>
<dt class="hdlist1">Prix du gaz</dt>
<dd>
<p>Le prix du gaz (en wei) que le donneur d&#39;ordre est prêt à payer</p>
</dd>
<dt class="hdlist1">Limite de gaz</dt>
<dd>
<p>La quantité maximale de gaz que l&#39;initiateur est prêt à acheter pour cette transaction</p>
</dd>
<dt class="hdlist1">Destinataire</dt>
<dd>
<p>L&#39;adresse Ethereum de destination</p>
</dd>
<dt class="hdlist1">Valeur</dt>
<dd>
<p>La quantité d&#39;éther à envoyer à la destination</p>
</dd>
<dt class="hdlist1">Données</dt>
<dd>
<p>La charge utile de données binaires de longueur variable</p>
</dd>
<dt class="hdlist1">v,r,s</dt>
<dd>
<p>Les trois composants d&#39;une signature numérique ECDSA de l&#39;EOA d&#39;origine</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>La structure du message de transaction est sérialisée à l&#39;aide du schéma de codage Recursive Length Prefix (RLP) (ou Préfixe de longueur récursif), qui a été créé spécifiquement pour sérialisation de données simple et parfaite dans Ethereum. Tous les nombres dans Ethereum sont codés sous forme d&#39;entiers gros-boutiste, de longueurs multiples de 8 bits.</p>
</div>
<div class="paragraph">
<p>Notez que les étiquettes de champ (to, gas limit, etc.) sont affichées ici pour plus de clarté, mais ne font pas partie des données sérialisées de la transaction, qui contiennent les valeurs de champ codées RLP. En général, RLP ne contient aucun délimiteur de champ ou étiquette. Le préfixe de longueur de RLP est utilisé pour identifier la longueur de chaque champ. Tout ce qui dépasse la longueur définie appartient au champ suivant dans la structure.</p>
</div>
<div class="paragraph">
<p>Bien qu&#39;il s&#39;agisse de la structure de transaction réelle transmise, la plupart des représentations internes et des visualisations d&#39;interface utilisateur l&#39;agrémentent d&#39;informations supplémentaires, dérivées de la transaction ou de la chaîne de blocs.</p>
</div>
<div class="paragraph">
<p>Par exemple, vous remarquerez peut-être qu&#39;il n&#39;y a pas de données &quot;from&quot; dans l&#39;adresse identifiant l&#39;EOA d&#39;origine. En effet, la clé publique de l&#39;EOA peut être dérivée des composants v,r,s de la signature ECDSA. L&#39;adresse peut, à son tour, être dérivée de la clé publique. Lorsque vous voyez une transaction affichant un champ &quot;from&quot;, qui a été ajouté par le logiciel utilisé pour visualiser la transaction. D&#39;autres métadonnées fréquemment ajoutées à la transaction par le logiciel client incluent le numéro de bloc (une fois extrait et inclus dans la chaîne de blocs) et un ID de transaction (hachage calculé). Encore une fois, ces données sont dérivées de la transaction et ne font pas partie du message de transaction lui-même.</p>
</div>
</div>
<div class="sect2">
<h3 id="tx_nonce">Le Nonce de transaction</h3>
<div class="paragraph">
<p>Le nonce est l&#39;un des composants les plus importants et les moins compris d&#39;une transaction. La définition du Livre jaune (voir <a href="#references">[references]</a>) lit :</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>nonce : Une valeur scalaire égale au nombre de transactions émises depuis cette adresse ou, dans le cas de comptes avec code associé, au nombre de créations de contrats effectuées par ce compte.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>À proprement parler, le nonce est un attribut de l&#39;adresse d&#39;origine ; c&#39;est-à-dire qu&#39;il n&#39;a de sens que dans le contexte de l&#39;adresse d&#39;envoi. Cependant, le nonce n&#39;est pas stocké explicitement dans le cadre de l&#39;état d&#39;un compte sur la chaîne de blocs. Au lieu de cela, il est calculé dynamiquement, en comptant le nombre de transactions confirmées provenant d&#39;une adresse.</p>
</div>
<div class="paragraph">
<p>Il existe deux scénarios dans lesquels l&#39;existence d&#39;un nonce de comptage des transactions est importante : la fonctionnalité d&#39;utilisabilité des transactions incluses dans l&#39;ordre de création et la fonctionnalité vitale de la protection contre la duplication des transactions. Regardons un exemple de scénario pour chacun d&#39;entre eux :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Imaginez que vous souhaitiez effectuer deux transactions. Vous avez un paiement important à effectuer de 6 ethers, et aussi un autre paiement de 8 ethers. Vous signez et diffusez d&#39;abord la transaction à 6 ethers, car c&#39;est la plus importante, puis vous signez et diffusez la deuxième transaction à 8 ethers. Malheureusement, vous avez oublié le fait que votre compte ne contient que 10 ethers, donc le réseau ne peut pas accepter les deux transactions : l&#39;une d&#39;entre elles échouera. Parce que vous avez envoyé le 6-ether le plus important en premier, vous vous attendez naturellement à ce que celui-ci passe et que le 8-ether soit rejeté. Cependant, dans un système décentralisé comme Ethereum, les nœuds peuvent recevoir les transactions dans n&#39;importe quel ordre ; il n&#39;y a aucune garantie qu&#39;un nœud particulier aura une transaction qui lui sera propagée avant l&#39;autre. En tant que tel, il sera presque certainement le cas que certains nœuds reçoivent la transaction à 6 ethers en premier et que d&#39;autres reçoivent la transaction à 8 ethers en premier. Sans le nonce, il serait aléatoire de savoir lequel est accepté et lequel est rejeté. Cependant, avec le nonce inclus, la première transaction que vous avez envoyée aura un nonce de, disons, 3, tandis que la transaction 8-ether a la valeur de nonce suivante (c&#39;est-à-dire 4). Ainsi, cette transaction sera ignorée jusqu&#39;à ce que les transactions avec des nonces de 0 à 3 aient été traitées, même si elle est reçue en premier. Phew!</p>
</li>
<li>
<p>Imaginez maintenant que vous avez un compte avec 100 ethers. Fantastique! Vous trouvez quelqu&#39;un en ligne qui acceptera le paiement en ether pour un mcguffin-widget que vous voulez vraiment acheter. Vous leur envoyez 2 ethers et ils vous envoient le widget mcguffin. Beau. Pour effectuer ce paiement à 2 ethers, vous avez signé une transaction en envoyant 2 ethers de votre compte à leur compte, puis vous les avez diffusés sur le réseau Ethereum pour qu&#39;ils soient vérifiés et inclus dans la chaîne de blocs. Maintenant, sans valeur nonce dans la transaction, une seconde transaction envoyant 2 ethers à la même adresse une seconde fois aura exactement la même apparence que la première transaction. Cela signifie que toute personne qui voit votre transaction sur le réseau Ethereum (ce qui signifie que tout le monde, y compris le destinataire ou vos ennemis) peut &quot;rejouer&quot; la transaction encore et encore et encore jusqu&#39;à ce que tout votre ether soit parti simplement en copiant et collant votre transaction d&#39;origine et le renvoyer sur le réseau. Cependant, avec la valeur nonce incluse dans les données de transaction, <em>chaque transaction est unique</em>, même lors de l&#39;envoi de la même quantité d&#39;éther à la même adresse de destinataire plusieurs fois. Ainsi, en ayant le nonce incrémenté dans le cadre de la transaction, il n&#39;est tout simplement pas possible pour quiconque de &quot;dupliquer&quot; un paiement que vous avez effectué.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>En résumé, il est important de noter que l&#39;utilisation du nonce est en fait vitale pour un protocole <em>basé sur le compte</em>, contrairement au mécanisme &quot;Unspent Transaction Output&quot; (UTXO) du protocole Bitcoin.</p>
</div>
<div class="sect3">
<h4 id="tracking_nonce">Garder une trace des Nonces</h4>
<div class="paragraph">
<p>En termes pratiques, le nonce est un décompte à jour du nombre de transactions <em>confirmées</em> (c&#39;est-à-dire en chaîne) provenant d&#39;un compte. Pour savoir ce qu&#39;est le nonce, vous pouvez interroger la chaîne de blocs, par exemple via l&#39;interface web3. Ouvrez une console JavaScript dans Geth (ou votre interface web3 préférée) sur Ropsten testnet, puis tapez :</p>
</div>
<pre data-type="programlisting">
&gt; <strong>web3.eth.getTransactionCount("0x9e713963a92c02317a681b9bb3065a8249de124f")</strong>
40

</pre>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Le nonce est un compteur basé sur zéro, ce qui signifie que la première transaction a le nonce 0. Dans cet exemple, nous avons un nombre de transactions de 40, ce qui signifie que les nonces 0 à 39 ont été vus. Le nonce de la prochaine transaction devra être de 40.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Votre portefeuille gardera une trace des nonces pour chaque adresse qu&#39;il gère. C&#39;est assez simple à faire, tant que vous n&#39;effectuez des transactions qu&#39;à partir d&#39;un seul point. Disons que vous écrivez votre propre logiciel de portefeuille ou une autre application qui génère des transactions. Comment suivre les nonces ?</p>
</div>
<div class="paragraph">
<p>Lorsque vous créez une nouvelle transaction, vous affectez le nonce suivant dans la séquence. Mais jusqu&#39;à ce qu&#39;il soit confirmé, il ne comptera pas dans le total getTransactionCount.</p>
</div>
<div id="get_tx_count_bug" class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Soyez prudent lorsque vous utilisez la fonction getTransactionCount pour compter les transactions en attente, car vous pourriez rencontrer des problèmes si vous envoyez quelques transactions à la suite.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Regardons un exemple :</p>
</div>
<pre data-type="programlisting">
&gt; <strong>web3.eth.getTransactionCount("0x9e713963a92c02317a681b9bb3065a8249de124f", \
"pending")</strong>
40
&gt; <strong>web3.eth.sendTransaction({from: web3.eth.accounts[0], to: \
"0xB0920c523d582040f2BCB1bD7FB1c7C1ECEbdB34", value: web3.utils.toWei(0.01, "ether")});</strong>
&gt; <strong>web3.eth.getTransactionCount("0x9e713963a92c02317a681b9bb3065a8249de124f", \
"pending")</strong>
41
&gt; <strong>web3.eth.sendTransaction({from: web3.eth.accounts[0], to: \
"0xB0920c523d582040f2BCB1bD7FB1c7C1ECEbdB34", value: web3.utils.toWei(0.01, "ether")});</strong>
&gt; <strong>web3.eth.getTransactionCount("0x9e713963a92c02317a681b9bb3065a8249de124f", \
"pending")</strong>
41
&gt; <strong>web3.eth.sendTransaction({from: web3.eth.accounts[0], to: \
"0xB0920c523d582040f2BCB1bD7FB1c7C1ECEbdB34", value: web3.utils.toWei(0.01, "ether")});</strong>
&gt; <strong>web3.eth.getTransactionCount("0x9e713963a92c02317a681b9bb3065a8249de124f", \
"pending")</strong>
41

</pre>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Si vous essayez de recréer vous-même ces exemples de code dans la console javascript de Geth, vous devez utiliser web3.toWei() au lieu de web3.utils.toWei(). En effet, Geth utilise une ancienne version de la bibliothèque web3.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Comme vous pouvez le voir, la première transaction que nous avons envoyée a augmenté le nombre de transactions à 41, indiquant la transaction en attente. Mais lorsque nous avons envoyé trois autres transactions en succession rapide, l&#39;appel getTransactionCount ne les a pas comptées. Il n&#39;en comptait qu&#39;un, même si vous vous attendiez à ce qu&#39;il y en ait trois en attente dans le mempool. Si nous attendons quelques secondes pour permettre aux communications réseau de s&#39;établir, l&#39;appel getTransactionCount renverra le nombre attendu. Mais dans l&#39;intervalle, bien qu&#39;il y ait plus d&#39;une transaction en attente, cela pourrait ne pas nous aider.</p>
</div>
<div class="paragraph">
<p>Lorsque vous construisez une application qui construit des transactions, elle ne peut pas s&#39;appuyer sur <span class="keep-together"><code>getTransactionCount</code></span> pour les transactions en attente. Ce n&#39;est que lorsque les nombres en attente et confirmés sont égaux (toutes les transactions en attente sont confirmées) que vous pouvez faire confiance à la sortie de getTransactionCount pour démarrer votre compteur de nonce. Par la suite, gardez une trace du nonce dans votre application jusqu&#39;à ce que chaque transaction soit confirmée.</p>
</div>
<div class="paragraph">
<p>L&#39;interface JSON RPC de Parity propose la fonction parity_nextNonce, qui renvoie le prochain nonce à utiliser dans une transaction. La fonction parity_nextNonce compte correctement les nonces, même si vous construisez plusieurs transactions en succession rapide sans les confirmer :</p>
</div>
<pre data-type="programlisting">
$ <strong>curl --data '{"method":"parity_nextNonce", \
  "params":["0x9e713963a92c02317a681b9bb3065a8249de124f"],\
  "id":1,"jsonrpc":"2.0"}' -H "Content-Type: application/json" -X POST \
  localhost:8545</strong>

{"jsonrpc":"2.0","result":"0x32","id":1}

</pre>
<div id="parity_curl" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Parity dispose d&#39;une console Web pour accéder à l&#39;interface JSON RPC, mais ici nous utilisons un client HTTP en ligne de commande pour y accéder.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="gaps_nonce">Lacunes dans les nonces, les nonces en double et la confirmation</h4>
<div class="paragraph">
<p>Il est important de garder une trace des nonces si vous créez des transactions par programmation, surtout si vous le faites à partir de plusieurs processus indépendants <span class="keep-together">simultanément</span>.</p>
</div>
<div class="paragraph">
<p>Le réseau Ethereum traite les transactions de manière séquentielle, sur la base du nonce. Cela signifie que si vous transmettez une transaction avec nonce 0, puis transmettez une transaction avec nonce 2, la deuxième transaction ne sera incluse dans aucun bloc. Il sera stocké dans le mempool, pendant que le réseau Ethereum attend que le nonce manquant apparaisse. Tous les nœuds supposeront que le nonce manquant a simplement été retardé et que la transaction avec le nonce 2 a été reçue dans le désordre.</p>
</div>
<div class="paragraph">
<p>Si vous transmettez ensuite une transaction avec le nonce 1 manquant, les deux transactions (nonces 1 et 2) seront traitées et incluses (si elles sont valides, bien sûr). Une fois que vous avez comblé le vide, le réseau peut exploiter la transaction hors séquence qu&#39;il a conservée dans le mempool.</p>
</div>
<div class="paragraph">
<p>Cela signifie que si vous créez plusieurs transactions en séquence et que l&#39;une d&#39;entre elles n&#39;est officiellement incluse dans aucun bloc, toutes les transactions suivantes seront &quot;bloquées&quot;, en attendant le nonce manquant. Une transaction peut créer un &quot;écart&quot; par inadvertance dans la séquence nonce car elle n&#39;est pas valide ou n&#39;a pas suffisamment de gaz. Pour que les choses bougent à nouveau, vous devez transmettre une transaction valide avec le nonce manquant. Vous devez également garder à l&#39;esprit qu&#39;une fois qu&#39;une transaction avec le nonce &quot;manquant&quot; est validée par le réseau, toutes les transactions de diffusion avec les nonces suivants deviendront progressivement valides ; il n&#39;est pas possible de &quot;rappeler&quot; une transaction !</p>
</div>
<div class="paragraph">
<p>Si, en revanche, vous dupliquez accidentellement un nonce, par exemple en transmettant deux transactions avec le même nonce mais différents destinataires ou valeurs, l&#39;un d&#39;entre eux sera confirmé et l&#39;autre sera rejeté. Celui qui est confirmé sera déterminé par la séquence dans laquelle ils arrivent au premier nœud de validation qui les reçoit, c&#39;est-à-dire que ce sera assez aléatoire.</p>
</div>
<div class="paragraph">
<p>Comme vous pouvez le constater, le suivi des nonces est nécessaire, et si votre application ne gère pas correctement ce processus, vous rencontrerez des problèmes. Malheureusement, les choses deviennent encore plus difficiles si vous essayez de le faire simultanément, comme nous le verrons dans la section suivante.</p>
</div>
</div>
<div class="sect3">
<h4 id="concurrency">Concurrence, origine des transactions et nonces</h4>
<div class="paragraph">
<p>La concurrence est un aspect complexe de l&#39;informatique, et il apparaît parfois de manière inattendue, en particulier dans les systèmes en temps réel décentralisés et distribués comme <span class="keep-together">Ethereum</span>.</p>
</div>
<div class="paragraph">
<p>En termes simples, la concurrence est lorsque vous avez un calcul simultané par plusieurs systèmes indépendants. Ceux-ci peuvent se trouver dans le même programme (par exemple, multithreading), sur le même processeur (par exemple, multitraitement) ou sur différents ordinateurs (c&#39;est-à-dire, <span class="keep-together">systèmes</span> distribués). Ethereum, par définition, est un système qui permet la simultanéité des opérations (nœuds, clients, DApps) mais applique un état singleton par consensus.</p>
</div>
<div class="paragraph">
<p>Maintenant, imaginez que vous ayez plusieurs applications de portefeuille indépendantes qui génèrent des transactions à partir de la ou des mêmes adresses. Un exemple d&#39;une telle situation serait un échange traitant des retraits du portefeuille chaud de l&#39;échange (un portefeuille dont les clés sont stockées en ligne, contrairement à un portefeuille froid où les clés ne sont jamais en ligne). Idéalement, vous voudriez avoir plus d&#39;un ordinateur traitant les retraits, afin qu&#39;il ne devienne pas un goulot d&#39;étranglement ou un point de défaillance unique. Cependant, cela devient rapidement problématique, car le fait d&#39;avoir plus d&#39;un ordinateur produisant des retraits entraînera des problèmes épineux de concurrence, dont le moindre n&#39;est pas la sélection des nonces. Comment plusieurs ordinateurs générant, signant et diffusant des transactions à partir du même compte du portefeuille chaud (Hot Wallet) se coordonnent-ils ?</p>
</div>
<div class="paragraph">
<p>Vous pouvez utiliser un seul ordinateur pour attribuer des nonces, selon le principe du premier arrivé, premier servi, aux ordinateurs signant des transactions. Cependant, cet ordinateur est maintenant un point de défaillance unique. Pire encore, si plusieurs nonces sont attribués et que l&#39;un d&#39;entre eux n&#39;est jamais utilisé (à cause d&#39;une défaillance de l&#39;ordinateur traitant la transaction avec ce nonce), toutes les transactions suivantes restent bloquées.</p>
</div>
<div class="paragraph">
<p>Une autre approche serait de générer les transactions, mais de ne pas leur attribuer de nonce (et donc de les laisser non signées - rappelez-vous que le nonce fait partie intégrante des données de transaction et doit donc être inclus dans la signature numérique qui authentifie la transaction) . Vous pouvez ensuite les mettre en file d&#39;attente sur un seul nœud qui les signe et garde également une trace des nonces. Encore une fois, cependant, ce serait un point d&#39;étranglement dans le processus : la signature et le suivi des nonces est la partie de votre opération qui est susceptible d&#39;être encombrée sous charge, alors que la génération de la transaction non signée est la partie que vous n&#39;avez pas vraiment besoin de paralléliser. Vous auriez une certaine concurrence, mais il y aurait un manque dans une partie essentielle du processus.</p>
</div>
<div class="paragraph">
<p>En fin de compte, ces problèmes de simultanéité, en plus de la difficulté de suivre les soldes des comptes et les confirmations de transaction dans des processus indépendants, obligent la plupart des implémentations à éviter la simultanéité et à créer des goulots d&#39;étranglement tels qu&#39;un processus unique gérant toutes les transactions de retrait dans un échange, ou la mise en place de plusieurs des portefeuilles chauds qui peuvent fonctionner de manière totalement indépendante pour les retraits et ne doivent être rééquilibrés que par intermittence.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tx_gas">Gaz de transaction</h3>
<div class="paragraph">
<p>Nous avons un peu parlé du gaz dans les chapitres précédents, et nous en discutons plus en détail dans <a href="#gas">[gas]</a>. Cependant, couvrons quelques notions de base sur le rôle des composants gasPrice et gasLimit d&#39;une transaction.</p>
</div>
<div class="paragraph">
<p>Le gaz est le carburant d&#39;Ethereum. Le gaz n&#39;est pas de l&#39;ether, c&#39;est une monnaie virtuelle distincte avec son propre taux de change par rapport à l&#39;ether. Ethereum utilise du gaz pour contrôler la quantité de ressources qu&#39;une transaction peut utiliser, car elle sera traitée sur des milliers d&#39;ordinateurs à travers le monde. Le modèle de calcul ouvert (Turing-complet) nécessite une certaine forme de mesure afin d&#39;éviter les attaques par déni de service ou les transactions gourmandes en ressources par inadvertance.</p>
</div>
<div class="paragraph">
<p>Le gaz est séparé de l&#39;ether afin de protéger le système de la volatilité qui pourrait survenir avec les changements rapides de la valeur de l&#39;ether, et aussi comme moyen de gérer les rapports importants et sensibles entre les coûts des diverses ressources que le gaz paie. (à savoir, calcul, mémoire et stockage).</p>
</div>
<div class="paragraph">
<p>Le champ gasPrice dans une transaction permet à l&#39;initiateur de la transaction de définir le prix qu&#39;il est prêt à payer en échange de gaz. Le prix est mesuré en wei par unité de gaz. Par exemple, dans l&#39;exemple de transaction dans <a href="#intro_chapter">[intro_chapter]</a> votre portefeuille fixe le gasPrice à 3 gwei (3 gigawei ou 3 milliards de wei).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Le site populaire <a href="https://ethgasstation.info/">ETH Gas Station</a> fournit des informations sur les prix actuels du gaz et d&#39;autres paramètres de gaz pertinents pour le réseau principal Ethereum.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Les portefeuilles peuvent ajuster le gasPrice dans les transactions qu&#39;ils génèrent pour obtenir une confirmation plus rapide des transactions. Plus le gasPrice est élevé, plus la transaction est susceptible d&#39;être confirmée rapidement. À l&#39;inverse, les transactions moins prioritaires peuvent avoir un prix réduit, ce qui entraîne une confirmation plus lente. La valeur minimale à laquelle gasPrice peut être défini est zéro, ce qui signifie une transaction sans frais. Pendant les périodes de faible demande d&#39;espace dans un bloc, de telles transactions pourraient très bien être minées.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Le gasPrice minimum acceptable est zéro. Cela signifie que les portefeuilles peuvent générer des transactions totalement gratuites. Selon la capacité, celles-ci peuvent ne jamais être confirmées, mais rien dans le protocole n&#39;interdit les transactions gratuites. Vous pouvez trouver plusieurs exemples de telles transactions incluses avec succès sur la chaîne de blocs Ethereum.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="gas_price_suggestion" class="paragraph">
<p>L&#39;interface web3 propose une suggestion gasPrice, en calculant un prix médian sur plusieurs blocs (nous pouvons utiliser la console truffle ou n&#39;importe quelle console web3 JavaScript pour le faire) :</p>
</div>
<pre data-type="programlisting">
> <strong>web3.eth.getGasPrice(console.log)</strong>
> null BigNumber { s: 1, e: 10, c: [ 10000000000 ] }

</pre>
<div id="calc_gas_price" class="paragraph">
<p>Le deuxième champ important lié au gaz est gasLimit. En termes simples, gasLimit donne le nombre maximum d&#39;unités de gaz que l&#39;initiateur de la transaction est prêt à acheter pour finaliser la transaction. Pour les paiements simples, c&#39;est-à-dire les transactions qui transfèrent de l&#39;ether d&#39;un EOA à un autre EOA, la quantité de gaz nécessaire est fixée à 21 000 unités de gaz. Pour calculer combien d&#39;ether cela coûtera, vous multipliez 21 000 par le gasPrice que vous êtes prêt à payer. Par example:</p>
</div>
<pre data-type="programlisting">
> <strong>web3.eth.getGasPrice(function(err, res) {console.log(res*21000)} )</strong>
> 210000000000000

</pre>
<div class="paragraph">
<p>Si l&#39;adresse de destination de votre transaction est un contrat, la quantité de gaz nécessaire peut être estimée mais ne peut pas être déterminée avec précision. En effet, un contrat peut évaluer différentes conditions qui conduisent à différentes voies d&#39;exécution, avec différents coûts totaux du gaz. Le contrat peut n&#39;exécuter qu&#39;un calcul simple ou un calcul plus complexe, selon des conditions indépendantes de votre volonté et imprévisibles. Pour le démontrer, regardons un exemple : nous pouvons écrire un contrat intelligent qui incrémente un compteur à chaque fois qu&#39;il est appelé et exécute une boucle particulière un nombre de fois égal au nombre d&#39;appels. Peut-être qu&#39;au 100e appel, il distribue un prix spécial, comme une loterie, mais doit faire des calculs supplémentaires pour calculer le prix. Si vous appelez le contrat 99 fois, une chose se produit, mais au 100e appel, quelque chose de très différent se produit. La quantité de gaz que vous paieriez pour cela dépend du nombre d&#39;autres transactions qui ont appelé cette fonction avant que votre transaction ne soit incluse dans un bloc. Peut-être que votre estimation est basée sur la 99e transaction, mais juste avant que votre transaction ne soit confirmée, quelqu&#39;un d&#39;autre appelle le contrat pour la 99e fois. Vous êtes maintenant la 100e transaction à appeler, et l&#39;effort de calcul (et le coût du gaz) est beaucoup plus élevé.</p>
</div>
<div class="paragraph">
<p>Pour emprunter une analogie courante utilisée dans Ethereum, vous pouvez considérer gasLimit comme la capacité du réservoir de carburant de votre voiture (votre voiture est la transaction). Vous remplissez le réservoir avec autant d&#39;essence que vous pensez qu&#39;il en aura besoin pour le trajet (le calcul nécessaire pour valider votre transaction). Vous pouvez estimer le montant dans une certaine mesure, mais il peut y avoir des changements inattendus dans votre trajet, comme une déviation (un chemin d&#39;exécution plus complexe), qui augmentent la consommation de carburant.</p>
</div>
<div class="paragraph">
<p>L&#39;analogie avec un réservoir de carburant est cependant quelque peu trompeuse. Il s&#39;agit en fait plus d&#39;un compte de crédit pour une entreprise de station-service, où vous payez une fois le voyage terminé, en fonction de la quantité d&#39;essence que vous avez réellement utilisée. Lorsque vous transmettez votre transaction, l&#39;une des premières étapes de validation consiste à vérifier que le compte dont elle provient dispose de suffisamment d&#39;ether pour payer la limite gasPrice * gaz. Mais le montant n&#39;est pas réellement déduit de votre compte tant que la transaction n&#39;est pas terminée. Vous n&#39;êtes facturé que pour le gaz réellement consommé par votre transaction, mais vous devez disposer d&#39;un solde suffisant pour le montant maximum que vous êtes prêt à payer avant d&#39;envoyer votre transaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="tx_recipient">Destinataire de la transaction</h3>
<div class="paragraph">
<p>Le destinataire d&#39;une transaction est spécifié dans le champ to. Celui-ci contient une adresse Ethereum de 20 octets. L&#39;adresse peut être une EOA ou une adresse de contrat.</p>
</div>
<div class="paragraph">
<p>Ethereum ne valide plus ce champ. Toute valeur de 20 octets est considérée comme valide. Si la valeur de 20 octets correspond à une adresse sans clé privée correspondante, ou sans contrat correspondant, la transaction est toujours valide. Ethereum n&#39;a aucun moyen de savoir si une adresse a été correctement dérivée d&#39;une clé publique (et donc d&#39;une clé privée) existante.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Le protocole Ethereum ne valide pas les adresses des destinataires dans les transactions. Vous pouvez envoyer à une adresse qui n&#39;a pas de clé privée ou de contrat correspondant, &quot;brûlant&quot; ainsi l&#39;ether, le rendant à jamais inutilisable. La validation doit être effectuée au niveau de l&#39;interface utilisateur.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>L&#39;envoi d&#39;une transaction à la mauvaise adresse va probablement <em>brûler</em> l&#39;ether envoyé, le rendant à jamais inaccessible (inutilisable), puisque la plupart des adresses n&#39;ont pas de clé privée connue et donc aucune signature ne peut être générée pour le dépenser. On suppose que la validation de l&#39;adresse se produit au niveau de l&#39;interface utilisateur (voir <a href="#EIP55">[EIP55]</a>). En fait, il existe un certain nombre de raisons valables pour brûler de l&#39;ether - par exemple, pour dissuader de tricher dans les canaux de paiement et autres contrats intelligents - et puisque la quantité d&#39;ether est finie, brûler de l&#39;ether distribue efficacement la valeur brûlée à tous les détenteurs d&#39;ether. (proportionnellement à la quantité d&#39;ether qu&#39;ils contiennent).</p>
</div>
</div>
<div class="sect2">
<h3 id="tx_value_data">Valeur et données de la transaction</h3>
<div class="paragraph">
<p>La &quot;charge utile&quot; principale d&#39;une transaction est contenue dans deux champs : value et data. Les transactions peuvent avoir à la fois une valeur et des données, uniquement une valeur, uniquement des données ou ni valeur ni données. Les quatre combinaisons sont valides.</p>
</div>
<div class="paragraph">
<p>Une transaction avec seulement une valeur est un <em>paiement</em>. Une transaction avec uniquement des données est une <em>invocation</em>. Une transaction comportant à la fois de la valeur et des données est à la fois un paiement et une invocation. Une transaction sans valeur ni données - eh bien, ce n&#39;est probablement qu&#39;un gaspillage de gaz ! Mais c&#39;est encore possible.</p>
</div>
<div class="paragraph">
<p>Essayons toutes ces combinaisons. Nous allons d&#39;abord définir les adresses source et de destination de notre portefeuille, juste pour rendre la démo plus facile à lire :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">src = web3.eth.accounts[0];
dst = web3.eth.accounts[1];</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notre première transaction ne contient qu&#39;une valeur (paiement) et aucune charge de données :</p>
</div>
<div id="tx_value_nodata_src" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">web3.eth.sendTransaction({from: src, to: dst, \
  value: web3.utils.toWei(0.01, "ether"), data: ""});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notre portefeuille affiche un écran de confirmation indiquant la valeur à envoyer, comme indiqué dans <a href="#parity_txdemo_value_nodata">Portefeuille de Parity montrant une transaction avec une valeur, mais pas de données</a>.</p>
</div>
<div id="parity_txdemo_value_nodata" class="imageblock">
<div class="content">
<img src="images/parity_txdemo_value_nodata.png" alt="&quot;Portefeuille de Parity montrant une transaction avec valeur" width="mais pas de données&quot;">
</div>
<div class="title">Figure 1. Portefeuille de Parity montrant une transaction avec une valeur, mais pas de données</div>
</div>
<div class="paragraph">
<p>L&#39;exemple suivant spécifie à la fois une valeur et une charge utile de données :</p>
</div>
<div id="tx_value_data_src" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">web3.eth.sendTransaction({from: src, to: dst, \
  value: web3.utils.toWei(0.01, "ether"), data: "0x1234"});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notre portefeuille affiche un écran de confirmation indiquant la valeur à envoyer ainsi que la charge utile des données, comme indiqué dans <a href="#parity_txdemo_value_data">Portefeuille de Parity montrant une transaction avec valeur et données</a>.</p>
</div>
<div id="parity_txdemo_value_data" class="imageblock">
<div class="content">
<img src="images/parity_txdemo_value_data.png" alt="&quot;Portefeuille de Parity montrant une transaction avec valeur et données&quot;">
</div>
<div class="title">Figure 2. Portefeuille de Parity montrant une transaction avec valeur et données</div>
</div>
<div class="paragraph">
<p>La transaction suivante inclut une charge utile de données mais spécifie une valeur de zéro :</p>
</div>
<div id="tx_novalue_data_src" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">web3.eth.sendTransaction({from: src, to: dst, value: 0, data: "0x1234"});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notre portefeuille affiche un écran de confirmation indiquant la valeur zéro et la charge utile des données, comme indiqué dans <a href="#parity_txdemo_novalue_data">Portefeuille de Parity montrant une transaction sans valeur, uniquement des données</a>.</p>
</div>
<div id="parity_txdemo_novalue_data" class="imageblock">
<div class="content">
<img src="images/parity_txdemo_novalue_data.png" alt="&quot;Portefeuille de Parity montrant une transaction sans valeur" width="uniquement des données&quot;">
</div>
<div class="title">Figure 3. Portefeuille de Parity montrant une transaction sans valeur, uniquement des données</div>
</div>
<div class="paragraph pagebreak-before">
<p>Enfin, la dernière transaction n&#39;inclut ni valeur à envoyer ni données utiles :</p>
</div>
<div id="tx_novalue_nodata_src" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">web3.eth.sendTransaction({from: src, to: dst, value: 0, data: ""}));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notre portefeuille affiche un écran de confirmation indiquant la valeur zéro, comme indiqué dans <a href="#parity_txdemo_novalue_nodata">Portefeuille de Parity montrant une transaction sans valeur et sans données</a>.</p>
</div>
<div id="parity_txdemo_novalue_nodata" class="imageblock">
<div class="content">
<img src="images/parity_txdemo_novalue_nodata.png" alt="&quot;Portefeuille de Parity montrant une transaction sans valeur et sans données&quot;">
</div>
<div class="title">Figure 4. Portefeuille de Parity montrant une transaction sans valeur et sans données</div>
</div>
<div class="sect3">
<h4 id="value_EOA_contracts">Transmettre de la valeur aux EOA et aux contrats</h4>
<div class="paragraph">
<p>Lorsque vous construisez une transaction Ethereum qui contient une valeur, c&#39;est l&#39;équivalent d&#39;un <em>paiement</em>. Ces transactions se comportent différemment selon que l&#39;adresse de destination est un contrat ou non.</p>
</div>
<div class="paragraph">
<p>Pour les adresses EOA, ou plutôt pour toute adresse qui n&#39;est pas signalée comme un contrat sur la chaîne de blocs, Ethereum enregistrera un changement d&#39;état, ajoutant la valeur que vous avez envoyée au solde de l&#39;adresse. Si l&#39;adresse n&#39;a pas été vue auparavant, elle sera ajoutée à la représentation interne de l&#39;état du client et son solde initialisé à la valeur de votre paiement.</p>
</div>
<div class="paragraph">
<p>Si l&#39;adresse de destination (to) est un contrat, alors l&#39;EVM exécutera le contrat et tentera d&#39;appeler la fonction nommée dans la charge utile de données de votre transaction. S&#39;il n&#39;y a pas de données dans votre transaction, l&#39;EVM appellera une fonction <em>fallback</em> (ou fonction de repli ou par défaut) et, si cette fonction est payante, l&#39;exécutera pour déterminer ce qu&#39;il faut faire ensuite. S&#39;il n&#39;y a pas de code dans la fonction de secours, l&#39;effet de la transaction sera d&#39;augmenter le solde du contrat, exactement comme un paiement sur un portefeuille. S&#39;il n&#39;y a pas de fonction de secours ou de fonction de secours non payante, la transaction sera annulée.</p>
</div>
<div class="paragraph">
<p>Un contrat peut rejeter les paiements entrants en levant une exception immédiatement lorsqu&#39;une fonction est appelée, ou tel que déterminé par des conditions codées dans une fonction. Si la fonction se termine avec succès (sans exception), l&#39;état du contrat est mis à jour pour refléter une augmentation du solde d&#39;ether du contrat.</p>
</div>
</div>
<div class="sect3">
<h4 id="data_EOA">Transmission d&#39;une charge utile de données à un EOA ou à un contrat</h4>
<div class="paragraph">
<p>Lorsque votre transaction contient des données, elle est très probablement adressée à une adresse de contrat. Cela ne signifie pas que vous ne pouvez pas envoyer une charge utile de données à un EOA, ce qui est tout à fait valide dans le protocole Ethereum. Cependant, dans ce cas, l&#39;interprétation des données dépend du portefeuille que vous utilisez pour accéder à l&#39;EOA. Il est ignoré par le protocole Ethereum. La plupart des portefeuilles ignorent également toutes les données reçues lors d&#39;une transaction vers un EOA qu&#39;ils contrôlent. À l&#39;avenir, il est possible que des normes émergent qui permettent aux portefeuilles d&#39;interpréter les données comme le font les contrats, permettant ainsi aux transactions d&#39;invoquer des fonctions exécutées à l&#39;intérieur des portefeuilles des utilisateurs. La différence essentielle est que toute interprétation de la charge utile de données par un EOA n&#39;est pas soumise aux règles de consensus d&#39;Ethereum, contrairement à un contrat <span class="keep-together">exécution</span>.</p>
</div>
<div class="paragraph">
<p>Pour l&#39;instant, supposons que votre transaction envoie des données à une adresse contractuelle. Dans ce cas, les données seront interprétées par l&#39;EVM comme une <em>invocation de contrat</em>.  La plupart des contrats utilisent ces données plus spécifiquement comme <em>invocation de fonction</em>, appelant la fonction nommée et transmettant tous les arguments codés à la fonction.</p>
</div>
<div class="paragraph">
<p>La charge utile de données envoyée à un contrat compatible ABI (dont vous pouvez supposer que tous les contrats le sont) est un codage hexadécimal de :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Un sélecteur de fonction</dt>
<dd>
<p>Les 4 premiers octets du hachage Keccak-256 du prototype de la fonction. Cela permet au contrat d&#39;identifier sans ambiguïté la fonction que vous souhaitez invoquer.</p>
</dd>
<dt class="hdlist1">Les arguments de la fonction</dt>
<dd>
<p>Les arguments de la fonction, encodés selon les règles des différents types élémentaires définies dans la spécification ABI.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Dans <a href="#solidity_faucet_example">[solidity_faucet_example]</a>, nous avons défini une fonction pour les retraits :</p>
</div>
<div id="withdraw_function_src" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-solidity" data-lang="solidity">function withdraw(uint withdraw_amount) public {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le <em>prototype</em> d&#39;une fonction est défini comme la chaîne contenant le nom de la fonction, suivi des types de données de chacun de ses arguments, entre parenthèses et séparés par des virgules. Le nom de la fonction ici est withdraw et il prend un seul argument qui est un uint (qui est un alias pour uint256), donc le prototype de withdraw serait :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-solidity" data-lang="solidity">withdraw(uint256)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calculons le hachage Keccak-256 de cette chaîne :</p>
</div>
<pre data-type="programlisting">
> <strong>web3.utils.sha3("withdraw(uint256)");</strong>
'0x2e1a7d4d13322e7b96f9a57413e1525c250fb7a9021cf91d1540d5b69f16a49f'

</pre>
<div class="paragraph">
<p>Les 4 premiers octets du hachage sont 0x2e1a7d4d. C&#39;est notre valeur &quot;sélecteur de fonction&quot;, qui indiquera au contrat quelle fonction nous voulons appeler.</p>
</div>
<div class="paragraph">
<p>Ensuite, calculons une valeur à passer comme argument withdraw_amount. Nous voulons retirer 0,01 ether. Encodons cela en un entier 256 bits non signé gros-boutiste hexa-sérialisé, libellé en wei :</p>
</div>
<pre data-type="programlisting">
> <strong>withdraw_amount = web3.utils.toWei(0.01, "ether");</strong>
'10000000000000000'
> <strong>withdraw_amount_hex = web3.utils.toHex(withdraw_amount);</strong>
'0x2386f26fc10000'

</pre>
<div class="paragraph">
<p>Maintenant, nous ajoutons le sélecteur de fonction au montant (rembourré à 32 octets) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2e1a7d4d000000000000000000000000000000000000000000000000002386f26fc10000</pre>
</div>
</div>
<div class="paragraph">
<p>C&#39;est la charge utile de données pour notre transaction, appelant la fonction withdraw et demandant 0,01 éther comme withdraw_amount.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="contract_reg">Transaction spéciale : création de contrat</h3>
<div class="paragraph">
<p>Un cas particulier que nous devrions mentionner est une transaction qui <em>crée un nouveau contrat</em> sur la chaîne de blocs, le déployant pour une utilisation future. Les transactions de création de contrat sont envoyées à une adresse de destination spéciale appelée <em>adresse zéro</em> ; le champ to dans une transaction d&#39;enregistrement de contrat contient l&#39;adresse 0x0. Cette adresse ne représente ni un EOA (il n&#39;y a pas de paire de clés privée-publique correspondante) ni un contrat. Il ne peut jamais dépenser d&#39;ether ou initier une transaction. Il n&#39;est utilisé que comme destination, avec la signification spéciale &quot;créer ce contrat&quot;.</p>
</div>
<div class="paragraph">
<p>Alors que l&#39;adresse zéro est destinée uniquement à la création de contrats, elle reçoit parfois des paiements de différentes adresses. Il y a deux explications à cela : soit c&#39;est par accident, entraînant la perte d&#39;éther, soit c&#39;est une <em>brûlure d&#39;ether</em> intentionnelle (détruisant délibérément l&#39;ether en l&#39;envoyant à une adresse d&#39;où il ne peut jamais être dépensé). Cependant, si vous souhaitez effectuer une brûlure intentionnelle d&#39;ether, vous devez indiquer clairement votre intention au réseau et utiliser à la place l&#39;adresse de brpulure spécialement désignée :</p>
</div>
<div id="burn_address" class="listingblock">
<div class="content">
<pre>0x000000000000000000000000000000000000dEaD</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Tout ether envoyé à l&#39;adresse de brûlure désignée deviendra inutilisable et sera perdu à jamais.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Une transaction de création de contrat ne doit contenir qu&#39;une charge utile de données contenant le bytecode compilé qui créera le contrat. Le seul effet de cette transaction est de créer le contrat. Vous pouvez inclure un montant en ether dans le champ value si vous souhaitez configurer le nouveau contrat avec un solde de départ, mais cela est entièrement facultatif. Si vous envoyez une valeur (ether) à l&#39;adresse de création de contrat sans charge utile de données (pas de contrat), l&#39;effet est le même que l&#39;envoi à une adresse de brûlure : il n&#39;y a pas de contrat à créditer, donc l&#39;ether est perdu.</p>
</div>
<div class="paragraph">
<p>Par exemple, nous pouvons créer le contrat <em>Faucet.sol</em> utilisé dans <a href="#intro_chapter">[intro_chapter]</a> en créant manuellement une transaction à l&#39;adresse zéro avec le contrat dans la charge utile des données. Le contrat doit être compilé dans une représentation en bytecode. Cela peut être fait avec le compilateur Solidity :</p>
</div>
<pre data-type="programlisting" class="pagebreak-before">
$ <strong>solc --bin Faucet.sol</strong>

Binary:
6060604052341561000f57600080fd5b60e58061001d6000396000f30060606040526004361060...

</pre>
<div class="paragraph">
<p>Les mêmes informations peuvent également être obtenues à partir du compilateur en ligne Remix.</p>
</div>
<div class="paragraph">
<p>Nous pouvons maintenant créer la transaction :</p>
</div>
<pre data-type="programlisting">
> <strong>src = web3.eth.accounts[0];</strong>
> <strong>faucet_code = \
  "0x6060604052341561000f57600080fd5b60e58061001d6000396000f300606...f0029";</strong>
> <strong>web3.eth.sendTransaction({from: src, to: 0, data: faucet_code, \
  gas: 113558, gasPrice: 200000000000});</strong>

"0x7bcc327ae5d369f75b98c0d59037eec41d44dfae75447fd753d9f2db9439124b"

</pre>
<div class="paragraph">
<p>Il est recommandé de toujours spécifier un paramètre to, même dans le cas d&#39;une création de contrat sans adresse, car le coût d&#39;envoyer accidentellement votre ether à 0x0 et de le perdre pour toujours est trop élevé. Vous devez également spécifier un gasPrice et un gasLimit.</p>
</div>
<div class="paragraph">
<p>Une fois le contrat extrait, nous pouvons le voir sur l&#39;explorateur de blocs Etherscan, comme indiqué dans <a href="#publish_contract_from_web3">Etherscan montrant le contrat miné avec succès</a>.</p>
</div>
<div id="publish_contract_from_web3" class="imageblock">
<div class="content">
<img src="images/contract_published.png" alt="&quot;Etherscan montrant le contrat extrait avec succès&quot;">
</div>
<div class="title">Figure 5. Etherscan montrant le contrat miné avec succès</div>
</div>
<div class="paragraph">
<p>Nous pouvons regarder le reçu de la transaction pour obtenir des informations sur le contrat :</p>
</div>
<pre data-type="programlisting">
> <strong>web3.eth.getTransactionReceipt( \
  "0x7bcc327ae5d369f75b98c0d59037eec41d44dfae75447fd753d9f2db9439124b");</strong>

{
  blockHash: "0x6fa7d8bf982490de6246875deb2c21e5f3665b4422089c060138fc3907a95bb2",
  blockNumber: 3105256,
  contractAddress: "0xb226270965b43373e98ffc6e2c7693c17e2cf40b",
  cumulativeGasUsed: 113558,
  from: "0x2a966a87db5913c1b22a59b0d8a11cc51c167a89",
  gasUsed: 113558,
  logs: [],
  logsBloom: \
    "0x00000000000000000000000000000000000000000000000000...00000",
  status: "0x1",
  to: null,
  transactionHash: \
    "0x7bcc327ae5d369f75b98c0d59037eec41d44dfae75447fd753d9f2db9439124b",
  transactionIndex: 0
}

</pre>
<div class="paragraph">
<p>Cela inclut l&#39;adresse du contrat, que nous pouvons utiliser pour envoyer et recevoir des fonds du contrat, comme indiqué dans la section précédente :</p>
</div>
<pre data-type="programlisting">
> <strong>contract_address = "0xb226270965b43373e98ffc6e2c7693c17e2cf40b"</strong>
> <strong>web3.eth.sendTransaction({from: src, to: contract_address, \
  value: web3.utils.toWei(0.1, "ether"), data: ""});</strong>

"0x6ebf2e1fe95cc9c1fe2e1a0dc45678ccd127d374fdf145c5c8e6cd4ea2e6ca9f"

> <strong>web3.eth.sendTransaction({from: src, to: contract_address, value: 0, data: \
  "0x2e1a7d4d000000000000000000000000000000000000000000000000002386f26fc10000"});</strong>

"0x59836029e7ce43e92daf84313816ca31420a76a9a571b69e31ec4bf4b37cd16e"

</pre>
<div class="paragraph">
<p>Après un certain temps, les deux transactions sont visibles sur Etherscan, comme indiqué dans <a href="#publish_contract_transactions">Etherscan montrant les transactions d&#39;envoi et de réception de fonds</a>.</p>
</div>
<div id="publish_contract_transactions" class="imageblock">
<div class="content">
<img src="images/published_contract_transactions.png" alt="&quot;Etherscan affichant les transactions d&#39;envoi et de réception de fonds&quot;">
</div>
<div class="title">Figure 6. Etherscan montrant les transactions d&#39;envoi et de réception de fonds</div>
</div>
</div>
<div class="sect2">
<h3 id="digital_sign">Signatures numériques</h3>
<div class="paragraph">
<p>Jusqu&#39;à présent, nous n&#39;avons pas approfondi les détails sur les signatures numériques. Dans cette section, nous examinons le fonctionnement des signatures numériques et comment elles peuvent être utilisées pour présenter une preuve de propriété d&#39;une clé privée sans révéler cette clé privée.</p>
</div>
<div class="sect3">
<h4 id="ecdsa">L&#39;algorithme de signature numérique à courbe elliptique</h4>
<div class="paragraph">
<p>L&#39;algorithme de signature numérique utilisé dans Ethereum est l&#39;_Elliptic Curve Digital Signature Algorithm_ ( ECDSA). Il est basé sur des paires de clés privées-publiques à courbe elliptique, comme décrit dans <a href="#elliptic_curve">[elliptic_curve]</a>.</p>
</div>
<div class="paragraph">
<p>Une signature numérique sert trois objectifs dans Ethereum (voir l&#39;encadré suivant). Premièrement, la signature prouve que le propriétaire de la clé privée, qui est implicitement le propriétaire d&#39;un compte Ethereum, a <em>autorisé</em> la dépense d&#39;ether ou l&#39;exécution d&#39;un contrat. Deuxièmement, il garantit la <em>non-répudiation</em> : la preuve de l&#39;autorisation est indéniable. Troisièmement, la signature prouve que les données de transaction n&#39;ont pas été et <em>ne peuvent pas être modifiées</em> par quiconque après la signature de la transaction.</p>
</div>
<div id="digital_signature_definition" class="sidebarblock">
<div class="content">
<div class="title">Définition de Wikipedia d&#39;une signature numérique</div>
<div class="paragraph">
<p>Une <em>signature numérique</em> est un schéma mathématique permettant de présenter l&#39;authenticité de messages ou de documents numériques. Une signature numérique valide donne au destinataire des raisons de croire que le message a été créé par un expéditeur connu (authentification), que l&#39;expéditeur ne peut pas nier avoir envoyé le message (non-répudiation) et que le message n&#39;a pas été altéré en transit (intégrité) .</p>
</div>
<div class="paragraph">
<p><em>Source : <a href="https://en.wikipedia.org/wiki/Digital_signature" class="bare">https://en.wikipedia.org/wiki/Digital_signature</a></em></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="digital_sign_work">Comment fonctionnent les signatures numériques</h4>
<div class="paragraph">
<p>Une signature numérique est un schéma mathématique composé de deux parties. La première partie est un algorithme de création d&#39;une signature, à l&#39;aide d&#39;une clé privée (la clé de signature), à partir d&#39;un message (qui dans notre cas est la transaction). La deuxième partie est un algorithme qui permet à quiconque de vérifier la signature en utilisant uniquement le message et une clé publique.</p>
</div>
<div class="sect4">
<h5 id="digital_sign_create">Création d&#39;une signature numérique</h5>
<div class="paragraph">
<p>Dans l&#39;implémentation ECDSA d&#39;Ethereum, le &quot;message&quot; signé est la transaction , ou plus précisément, le hachage Keccak-256 des données encodées RLP de la transaction. La clé de signature est la clé privée de l&#39;EOA. Le résultat est la signature :</p>
</div>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mrow>
      <mi>S</mi>
      <mi>i</mi>
      <mi>g</mi>
    </mrow>
    <mo>=</mo>
    <msub><mi>F</mi> <mrow><mi>s</mi><mi>i</mi><mi>g</mi></mrow> </msub>
    <mrow>
      <mo>(</mo>
      <msub><mi>F</mi> <mrow><mi>k</mi><mi>e</mi><mi>c</mi><mi>c</mi><mi>a</mi><mi>k</mi><mn>256</mn></mrow> </msub>
      <mrow>
        <mo>(</mo>
        <mi>m</mi>
        <mo>)</mo>
      </mrow>
      <mo>,</mo>
      <mi>k</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
<div class="paragraph">
<p>où:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>k</em> est la clé privée de signature.</p>
</li>
<li>
<p><em>m</em> est la transaction codée RLP.</p>
</li>
<li>
<p><em>F</em><sub><em>keccak256</em></sub> est la fonction de hachage Keccak-256.</p>
</li>
<li>
<p><em>F</em><sub><em>sig</em></sub> est l&#39;algorithme de signature.</p>
</li>
<li>
<p><em>Sig</em> est la signature résultante.</p>
</li>
</ul>
</div>
<div id="sign_function" class="paragraph">
<p>La fonction <em>F</em><sub><em>sig</em></sub> produit une signature <em>Sig</em> composée de deux valeurs, communément appelées <em>r</em> et <em>s</em> :</p>
</div>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mrow>
      <mi>S</mi>
      <mi>i</mi>
      <mi>g</mi>
    </mrow>
    <mo>=</mo>
    <mo>(</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>s</mi>
    <mo>)</mo>
  </mrow>
</math>
</div>
</div>
</div>
<div class="sect3">
<h4 id="verify_sign">Vérification de la signature</h4>
<div class="paragraph">
<p>Pour vérifier la signature, il faut avoir la signature (<em>r</em> et <em>s</em>), la transaction sérialisée et la clé publique qui correspond à la clé privée utilisée pour créer la signature. Essentiellement, la vérification d&#39;une signature signifie que &quot;seul le propriétaire de la clé privée qui a généré cette clé publique pourrait avoir produit cette signature sur cette transaction&quot;.</p>
</div>
<div class="paragraph">
<p>L&#39;algorithme de vérification de signature prend le message (c&#39;est-à-dire, un hachage de la transaction pour notre usage), la clé publique du signataire et la signature (valeurs <em>r</em> et <em>s</em>), et renvoie true si la signature est valide pour ce message et la clé publique .</p>
</div>
</div>
<div class="sect3">
<h4 id="ecdsa_math">Mathématiques ECDSA</h4>
<div class="paragraph">
<p>Comme mentionné précédemment, les signatures sont créées par une fonction mathématique <em>F</em><sub><em>sig</em></sub> qui produit une signature composée de deux valeurs, <em>r</em> et <em>s</em>. Dans cette section, nous examinons la fonction <em>F</em><sub><em>sig</em></sub> plus en détail.</p>
</div>
<div class="paragraph">
<p>L&#39;algorithme de signature génère d&#39;abord une clé privée <em>éphémère</em> (temporaire) de manière cryptographiquement sécurisée. Cette clé temporaire est utilisée dans le calcul des valeurs <em>r</em> et <em>s</em> pour s&#39;assurer que la clé privée réelle de l&#39;expéditeur ne peut pas être calculée par des attaquants qui surveillent les transactions signées sur le réseau Ethereum.</p>
</div>
<div class="paragraph">
<p>Comme nous le savons depuis <a href="#pubkey">[pubkey]</a>, la clé privée éphémère est utilisée pour dériver la clé publique (éphémère) correspondante, nous avons donc :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un nombre aléatoire cryptographiquement sécurisé <em>q</em>, qui est utilisé comme clé privée éphémère</p>
</li>
<li>
<p>La clé publique éphémère correspondante <em>Q</em>, générée à partir de <em>q</em> et du point générateur de courbe elliptique <em>G</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La valeur <em>r</em> de la signature numérique est alors la coordonnée <em>x</em> de la clé publique éphémère <em>Q</em>.</p>
</div>
<div class="paragraph">
<p>A partir de là, l&#39;algorithme calcule la valeur <em>s</em> de la signature, telle que :</p>
</div>
<ul class="simplelist">
<li><em>s</em> &#8801; <em>q</em><sup>-1</sup> (<em>Keccak256</em>(<em>m</em>) + <em>r</em> * <em>k</em>)  &nbsp;  &nbsp; (<em>mod p</em>)</li>
</ul>
<div class="paragraph">
<p>où:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>q</em> est la clé privée éphémère.</p>
</li>
<li>
<p><em>r</em> est la coordonnée <em>x</em> de la clé publique éphémère.</p>
</li>
<li>
<p><em>k</em> est la clé privée de signature (propriétaire EOA).</p>
</li>
<li>
<p><em>m</em> est les données de transaction.</p>
</li>
<li>
<p><em>p</em> est l&#39;ordre premier de la courbe elliptique.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La vérification est l&#39;inverse de la fonction de génération de signature, utilisant les valeurs <em>r</em> et <em>s</em> et la clé publique de l&#39;expéditeur pour calculer une valeur <em>Q</em>, qui est un point sur la courbe elliptique (la clé publique éphémère utilisée dans la création de la signature). Les étapes sont les suivantes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Vérifiez que toutes les entrées sont correctement formées</p>
</li>
<li>
<p>Calculez <em>w</em> = <em>s</em><sup>-1</sup> <em>mod p</em></p>
</li>
<li>
<p>Calculez <em>u<sub>1</sub></em> = <em>Keccak256</em>(<em>m</em>) * <em>w</em> <em>mod p</em></p>
</li>
<li>
<p>Calculez <em>u<sub>2</sub></em> = <em>r</em> * <em>w</em> <em>mod p</em></p>
</li>
<li>
<p>Enfin, calculez le point sur la courbe elliptique <em>Q</em> ≡ <em>u<sub>1</sub></em> * <em>G</em> + <em>u<sub>2</sub></em> * <em>K</em> &#160; &#160; (<em>mod p</em>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>où:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>r</em> et <em>s</em> sont les valeurs de signature.</p>
</li>
<li>
<p><em>K</em> est la clé publique du signataire (propriétaire de l&#39;EOA).</p>
</li>
<li>
<p><em>m</em> est les données de transaction qui ont été signées.</p>
</li>
<li>
<p><em>G</em> est le point générateur de la courbe elliptique.</p>
</li>
<li>
<p><em>p</em> est l&#39;ordre premier de la courbe elliptique.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Si la coordonnée <em>x</em> du point calculé <em>Q</em> est égale à <em>r</em>, alors le vérificateur peut conclure que la signature est valide.</p>
</div>
<div class="paragraph">
<p>Notez qu&#39;en vérifiant la signature, la clé privée n&#39;est ni connue ni révélée.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>ECDSA est nécessairement un calcul assez compliqué; une explication complète est au-delà de la portée de ce livre. Un certain nombre d&#39;excellents guides en ligne vous guident étape par étape : recherchez &quot;ECDSA expliqué&quot; ou essayez celui-ci : <a href="http://bit.ly/2r0HhGB" class="bare">http://bit.ly/2r0HhGB</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="tx_sign">Signature de transaction en pratique</h4>
<div class="paragraph">
<p>Pour produire une transaction valide, l&#39;expéditeur doit signer numériquement le message, en utilisant l&#39;algorithme de signature numérique à courbe elliptique. Lorsque nous disons &quot;signer la transaction&quot;, nous entendons en fait &quot;signer le hachage Keccak-256 des données de transaction sérialisées RLP&quot;. La signature est appliquée au hachage des données de transaction, pas à la transaction elle-même.</p>
</div>
<div class="paragraph">
<p>Pour signer une transaction dans Ethereum, l&#39;initiateur doit :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Créez une structure de données de transaction contenant neuf champs : nonce, gasPrice, gasLimit, to, value, data, chainID, 0, 0.</p>
</li>
<li>
<p>Produire un message sérialisé codé RLP de la structure de données de transaction.</p>
</li>
<li>
<p>Calculez le hachage Keccak-256 de ce message sérialisé.</p>
</li>
<li>
<p>Calculez la signature ECDSA, en signant le hachage avec la clé privée de l&#39;EOA d&#39;origine.</p>
</li>
<li>
<p>Ajoutez les valeurs v, r et s calculées de la signature ECDSA à la transaction.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>La variable de signature spéciale v indique deux choses : l&#39;ID (identifiant) de chaîne et l&#39;identifiant de récupération pour aider la fonction ECDSArecover à vérifier la signature. Il est calculé comme l&#39;un des 27 ou 28, ou comme l&#39;ID de chaîne doublé plus 35 ou 36. Pour plus d&#39;informations sur l&#39;ID de chaîne, voir <a href="#raw_tx_eip155">Création de transactions brutes avec EIP-155</a>. L&#39;identifiant de récupération (27 ou 28 dans les signatures &quot;à l&#39;ancienne&quot;, ou 35 ou 36 dans les transactions complètes de type Spurious Dragon) est utilisé pour indiquer la parité du composant y de la clé publique (voir <a href="#sign_prefix">La valeur du préfixe de signature (v) et la récupération de la clé publique</a> pour plus de détails).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p> Au bloc #2 675 000, Ethereum a implémenté l&#8217;embranchement divergent &quot;Spurious Dragon&quot;, qui, entre autres changements, a introduit un nouveau schéma de signature qui inclut la protection contre la relecture des transactions (empêchant les transactions destinées à un réseau d&#39;être rejouées sur autres). Ce nouveau schéma de signature est spécifié dans EIP-155. Ce changement affecte la forme de la transaction et sa signature, il faut donc prêter attention à la première des trois variables de signature (c&#39;est-à-dire v), qui prend l&#39;une des deux formes et indique les champs de données inclus dans le message de transaction haché .</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="raw_tx">Création et signature de transactions brutes</h4>
<div class="paragraph">
<p>Dans cette section, nous allons créer une transaction brute et la signer, en utilisant la bibliothèque ethereumjs-tx, qui peut être installé avec npm. Cela démontre les fonctions qui seraient normalement utilisées dans un portefeuille ou une application qui signe des transactions au nom d&#39;un utilisateur. Le code source de cet exemple se trouve dans le fichier <em>raw_tx_demo.js</em> dans le <a href="http://bit.ly/2yI2GL3">référentiel GitHub</a> du livre :</p>
</div>
<div id="raw_tx_demo_source" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// Load requirements first:
//
// npm init
// npm install ethereumjs-tx
//
// Run with: $ node raw_tx_demo.js
const ethTx = require('ethereumjs-tx').Transaction;

const txData = {
  nonce: '0x0',
  gasPrice: '0x09184e72a000',
  gasLimit: '0x30000',
  to: '0xb0920c523d582040f2bcb1bd7fb1c7c1ecebdb34',
  value: '0x00',
  data: '',
  v: "0x1c", // Ethereum mainnet chainID
  r: 0,
  s: 0 
};

tx = new ethTx(txData);
console.log('RLP-Encoded Tx: 0x' + tx.serialize().toString('hex'))

txHash = tx.hash(); // This step encodes into RLP and calculates the hash
console.log('Tx Hash: 0x' + txHash.toString('hex'))

// Sign transaction
const privKey = Buffer.from(
    '91c8360c4cb4b5fac45513a7213f31d4e4a7bfcb4630e9fbf074f42a203ac0b9', 'hex');
tx.sign(privKey);

serializedTx = tx.serialize();
rawTx = 'Signed Raw Transaction: 0x' + serializedTx.toString('hex');
console.log(rawTx)</code></pre>
</div>
</div>
<div id="raw_tx_demo_run" class="paragraph">
<p>L&#39;exécution de l&#39;exemple de code produit les résultats suivants :</p>
</div>
<pre data-type="programlisting">
$ <strong>node raw_tx_demo.js</strong>
RLP-Encoded Tx: 0xe6808609184e72a0008303000094b0920c523d582040f2bcb1bd7fb1c7c1...
Tx Hash: 0xaa7f03f9f4e52fcf69f836a6d2bbc7706580adce0a068ff6525ba337218e6992
Signed Raw Transaction: 0xf866808609184e72a0008303000094b0920c523d582040f2bcb1...

</pre>
</div>
<div class="sect3">
<h4 id="raw_tx_eip155">Création de transactions brutes avec EIP-155</h4>
<div class="paragraph">
<p>La norme EIP-155 &quot;Simple Replay Attack Protection&quot; spécifie un codage de transaction protégé contre les attaques de relecture, qui inclut un <em>identifiant de chaîne</em> dans les données de transaction, avant la signature. Cela garantit que les transactions créées pour une chaîne de blocs (par exemple, le réseau principal Ethereum) sont invalides sur une autre chaîne de blocs (par exemple, Ethereum Classic ou le réseau de test Ropsten). Par conséquent, les transactions diffusées sur un réseau ne peuvent pas être <em>rejouées</em> sur un autre, d&#39;où le nom de la norme.</p>
</div>
<div class="paragraph">
<p>EIP-155 ajoute trois champs aux six principaux champs de la structure de données de transaction, à savoir l&#39;identifiant de chaîne, 0 et 0. Ces trois champs sont ajoutés aux données de transaction <em>avant qu&#39;elles ne soient encodées et hachées</em>. Ils modifient donc le hash de la transaction, auquel la signature est ensuite appliquée. En incluant l&#39;identifiant de la chaîne dans les données à signer, la signature de la transaction empêche tout changement, car la signature est invalidée si l&#39;identifiant de la chaîne est modifié. Par conséquent, EIP-155 rend impossible la relecture d&#39;une transaction sur une autre chaîne, car la validité de la signature dépend de l&#39;identifiant de la chaîne.</p>
</div>
<div class="paragraph">
<p>Le champ d&#39;identifiant de chaîne prend une valeur en fonction du réseau auquel la transaction est destinée, comme indiqué dans <a href="#chain_id_table">Identifiants de chaîne</a>.</p>
</div>
<table id="chain_id_table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Identifiants de chaîne</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Chaîne</th>
<th class="tableblock halign-left valign-top">ID de chaîne</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mainnet Ethereum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Morden (obsolète), Étendue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ropsten</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rinkeby</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mainnet Rootstock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet Rootstock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kovan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">42</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mainnet Ethereum Classic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">61</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet Ethereum Classic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">62</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testets privés Geth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1337</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>La structure de transaction résultante est codée RLP, hachée et signée. L&#39;algorithme de signature est légèrement modifié pour encoder également l&#39;identifiant de la chaîne dans le préfixe v.</p>
</div>
<div class="paragraph">
<p>Pour plus de détails, voir <a href="http://bit.ly/2CQUgne">la spécification EIP-155</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sign_prefix">La valeur du préfixe de signature (v) et la récupération de la clé publique</h3>
<div class="paragraph">
<p>Comme mentionné dans <a href="#tx_struct">La structure d&#39;une transaction</a>, le message de transaction n&#39;inclut pas de champ &quot;from&quot;. En effet, la clé publique de l&#39;expéditeur peut être calculée directement à partir de la signature ECDSA. Une fois que vous avez la clé publique, vous pouvez facilement calculer l&#39;adresse. Le processus de récupération de la clé publique du signataire est appelé <em>récupération de la clé publique</em>.</p>
</div>
<div class="paragraph">
<p>Étant donné les valeurs r et s qui ont été calculées dans <a href="#ecdsa_math">Mathématiques ECDSA</a>, nous pouvons calculer deux clés publiques possibles.</p>
</div>
<div class="paragraph">
<p>Tout d&#39;abord, nous calculons deux points de courbe elliptique, <em>R</em> et <em>R</em><sup><em>&#39;</em></sup>, à partir de la coordonnée <em>x</em> r valeur qui se trouve dans la signature. Il y a deux points parce que la courbe elliptique est symétrique sur l&#39;axe des x, de sorte que pour toute valeur x il y a deux valeurs possibles qui correspondent à la courbe, une de chaque côté de l&#39;axe des x.</p>
</div>
<div class="paragraph">
<p>À partir de r, nous calculons également <em>r</em><sup>-1</sup>, qui est l&#39;inverse multiplicatif de r.</p>
</div>
<div class="paragraph">
<p>Enfin, nous calculons <em>z</em>, qui correspond aux <em>n</em> bits les plus bas du hachage du message, où <em>n</em> est l&#39;ordre de la courbe elliptique.</p>
</div>
<div class="paragraph">
<p>Les deux clés publiques possibles sont alors :</p>
</div>
<ul class="simplelist">
<li><em>K</em><sub>1</sub> = <em>r</em><sup>&#x2013;1</sup> (<em>sR</em> &#x2013; <em>zG</em>)</li>
</ul>
<div class="paragraph">
<p>et:</p>
</div>
<ul class="simplelist">
<li><em>K</em><sub>2</sub> = <em>r</em><sup>&#x2013;1</sup> (<em>sR</em><sup>'</sup> &#x2013; <em>zG</em>)</li>
</ul>
<div class="paragraph">
<p>où:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>K</em><sub>1</sub> et <em>K</em><sub>2</sub> sont les deux possibilités pour la clé publique du signataire.</p>
</li>
<li>
<p><em>r</em><sup>-1</sup> est l&#39;inverse multiplicatif de la valeur r de la signature.</p>
</li>
<li>
<p><em>s</em> est la valeur s de la signature.</p>
</li>
<li>
<p><em>R</em> et <em>R</em><sup>&#39;</sup> sont les deux possibilités pour la clé publique éphémère <em>Q</em>.</p>
</li>
<li>
<p><em>z</em> correspond aux <em>n</em> bits les plus bas du hachage du message.</p>
</li>
<li>
<p><em>G</em> est le point générateur de la courbe elliptique.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pour rendre les choses plus efficaces, la signature de la transaction inclut une valeur de préfixe v, qui nous indique laquelle des deux valeurs <em>R</em> possibles est la clé publique éphémère. Si v est pair, alors <em>R</em> est la valeur correcte. Si v est impair, alors c&#39;est <em>R</em><sup>&#39;</sup>. De cette façon, nous devons calculer une seule valeur pour <em>R</em> et une seule valeur pour <em>K</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="offline_sign">Séparer la signature et la transmission (signature hors ligne)</h3>
<div class="paragraph">
<p>Une fois qu&#39;une transaction est signée, elle est prête à être transmise au réseau Ethereum . Les trois étapes de création, de signature et de diffusion d&#39;une transaction se déroulent normalement en une seule opération, par exemple en utilisant web3.eth.sendTransaction. Cependant, comme vous l&#39;avez vu dans <a href="#raw_tx">Création et signature de transactions brutes</a>, vous pouvez créer et signer la transaction en deux étapes distinctes. Une fois que vous avez une transaction signée, vous pouvez ensuite la transmettre à l&#39;aide de web3.eth.sendSignedTransaction, qui prend une transaction codée en hexadécimal et signée et la transmet sur le réseau Ethereum.</p>
</div>
<div class="paragraph">
<p>Pourquoi voudriez-vous séparer la signature et la transmission des transactions ? La raison la plus courante est la sécurité. L&#39;ordinateur qui signe une transaction doit avoir des clés privées déverrouillées chargées en mémoire. L&#39;ordinateur qui effectue la transmission doit être connecté à Internet (et exécuter un client Ethereum). Si ces deux fonctions sont sur un seul ordinateur, alors vous avez des clés privées sur un système en ligne, ce qui est assez dangereux. Séparer les fonctions de signature et de transmission et les exécuter sur différentes machines (sur un appareil hors ligne et en ligne, respectivement) est appelé <em>signature hors ligne</em> et est une pratique de sécurité courante.</p>
</div>
<div class="paragraph">
<p><a href="#offline_signing">Signature hors ligne des transactions Ethereum</a> montre le processus :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Créez une transaction non signée sur l&#39;ordinateur en ligne où l&#39;état actuel du compte, notamment le nonce actuel et les fonds disponibles, peut être récupéré.</p>
</li>
<li>
<p>Transférez la transaction non signée vers un appareil hors ligne « isolé » pour la signature de la transaction, par exemple via un code QR ou une clé USB.</p>
</li>
<li>
<p>Transmettez (retour) la transaction signée à un appareil en ligne pour diffusion sur la chaîne de blocs Ethereum, par exemple via un code QR ou une clé USB.</p>
</li>
</ol>
</div>
<div id="offline_signing" class="imageblock">
<div class="content">
<img src="images/offline_signing.png" alt="&quot;Signature hors ligne des transactions Ethereum&quot;">
</div>
<div class="title">Figure 7. Signature hors ligne des transactions Ethereum</div>
</div>
<div class="paragraph">
<p>Selon le niveau de sécurité dont vous avez besoin, votre ordinateur de &quot;signature hors ligne&quot; peut avoir différents degrés de séparation de l&#39;ordinateur en ligne, allant d&#39;un sous-réseau isolé et protégé par un pare-feu (en ligne mais séparé) à un système complètement hors ligne connu sous le nom de système <em>air-gapped</em> ou <em>à espacement d&#8217;air</em> . Dans un système à espacement d&#39;air, il n&#39;y a aucune connectivité réseau - l&#39;ordinateur est séparé de l&#39;environnement en ligne par un espace &quot;d&#39;air&quot;. Pour signer des transactions, vous les transférez vers et depuis l&#39;ordinateur isolé à l&#39;aide d&#39;un support de stockage de données ou (mieux) d&#39;une webcam et d&#39;un code QR. Bien sûr, cela signifie que vous devez transférer manuellement chaque transaction que vous souhaitez signer, et cela n&#39;évolue pas.</p>
</div>
<div class="paragraph">
<p>Bien que peu d&#39;environnements puissent utiliser un système entièrement isolé, même un faible degré d&#39;isolement présente des avantages significatifs en matière de sécurité. Par exemple, un sous-réseau isolé avec un pare-feu qui n&#39;autorise qu&#39;un protocole de file d&#39;attente de messages peut offrir une surface d&#39;attaque très réduite et une sécurité bien plus élevée que la signature sur le système en ligne. De nombreuses entreprises utilisent un protocole tel que ZeroMQ (0MQ) à cette fin. Avec une telle configuration, les transactions sont sérialisées et mises en file d&#39;attente pour signature. Le protocole de mise en file d&#39;attente transmet le message sérialisé, d&#39;une manière similaire à un socket TCP, à l&#39;ordinateur signataire. L&#39;ordinateur signataire lit les transactions sérialisées à partir de la file d&#39;attente (avec précaution), applique une signature avec la clé appropriée et les place dans une file d&#39;attente sortante. La file d&#39;attente sortante transmet les transactions signées à un ordinateur avec un client Ethereum qui les retire de la file d&#39;attente et les transmet.</p>
</div>
</div>
<div class="sect2">
<h3 id="tx_propagation">Propagation des transactions</h3>
<div class="paragraph">
<p>Le réseau Ethereum utilise un protocole de &quot;routage par inondation&quot;. Chaque client Ethereum agit comme un <em>nœud</em> dans un réseau <em>pair à pair (P2P)</em>, qui (idéalement) forme un réseau de <em>toile</em>. Aucun nœud de réseau n&#39;est spécial : ils agissent tous comme des pairs égaux. Nous utiliserons le terme &quot;nœud&quot; pour désigner un client Ethereum qui est connecté et participe au réseau P2P.</p>
</div>
<div class="paragraph">
<p>La propagation de la transaction commence par la création (ou la réception hors ligne) par le nœud Ethereum d&#39;origine d&#39;une transaction signée. La transaction est validée puis transmise à tous les autres nœuds Ethereum qui sont <em>directement</em> connectés au nœud d&#39;origine. En moyenne, chaque nœud Ethereum maintient des connexions avec au moins 13 autres nœuds, appelés ses <em>voisins</em>. Chaque nœud voisin valide la transaction dès qu&#39;il la reçoit. S&#39;ils conviennent qu&#39;il est valide, ils en stockent une copie et le propagent à tous leurs voisins (sauf celui dont il provient). En conséquence, la transaction se répercute vers l&#39;extérieur à partir du nœud d&#39;origine, <em>inondant</em> à travers le réseau, jusqu&#39;à ce que tous les nœuds du réseau aient une copie de la transaction. Les nœuds peuvent filtrer les messages qu&#39;ils propagent, mais la valeur par défaut consiste à propager tous les messages de transaction valides qu&#39;ils reçoivent.</p>
</div>
<div class="paragraph">
<p>En quelques secondes seulement, une transaction Ethereum se propage à tous les nœuds Ethereum du monde entier. Du point de vue de chaque nœud, il n&#39;est pas possible de discerner l&#39;origine de la transaction. Le voisin qui l&#39;a envoyé au nœud peut être l&#39;initiateur de la transaction ou peut l&#39;avoir reçue de l&#39;un de ses voisins. Pour pouvoir suivre l&#39;origine des transactions ou interférer avec la propagation, un attaquant devrait contrôler un pourcentage significatif de tous les nœuds. Cela fait partie de la conception de la sécurité et de la confidentialité des réseaux P2P, en particulier lorsqu&#39;elle est appliquée aux réseaux blockchain.</p>
</div>
</div>
<div class="sect2">
<h3 id="chain_record">Enregistrement sur la chaîne de blocs</h3>
<div class="paragraph">
<p>Bien que tous les nœuds d&#39;Ethereum soient des pairs égaux, certains d&#39;entre eux sont exploités par des <em>mineurs</em> et alimentent des transactions et des blocs vers des <em>fermes minières</em>, qui sont des ordinateurs dotés d&#39;unités de traitement graphique (GPU) hautes performances. Les ordinateurs de minage ajoutent des transactions à un bloc candidat et tentent de trouver une <em>preuve de travail</em> qui rend le bloc candidat valide. Nous en discuterons plus en détail dans <a href="#consensus">[consensus]</a>.</p>
</div>
<div class="paragraph">
<p>Sans entrer dans trop de détails, les transactions valides seront éventuellement incluses dans un bloc de transactions et, ainsi, enregistrées dans la chaîne de blocs Ethereum. Une fois minées dans un bloc, les transactions modifient également l&#39;état du singleton Ethereum, soit en modifiant le solde d&#39;un compte (dans le cas d&#39;un simple paiement) soit en invoquant des contrats qui changent leur état interne. Ces modifications sont enregistrées parallèlement à la transaction, sous la forme d&#39;un <em>reçu</em> de transaction, qui peut également inclure des <em>événements</em>. Nous examinerons tout cela beaucoup plus en détail dans <a href="#evm_chapter">[evm_chapter]</a>.</p>
</div>
<div class="paragraph">
<p>Une transaction qui a terminé son parcours depuis la création jusqu&#39;à la signature par un EOA, la propagation et enfin l&#39;exploitation minière a changé l&#39;état du singleton et laissé une marque indélébile sur la chaîne de blocs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_transactions_à_signatures_multiples_multisig">Transactions à signatures multiples (Multisig)</h3>
<div class="paragraph">
<p>Si vous connaissez les capacités de script de Bitcoin, vous savez qu&#39;il est possible de créer un compte multisig Bitcoin qui ne peut dépenser des fonds que lorsque plusieurs parties signent la transaction (par exemple, 2 sur 2 ou 3 sur 4 signatures). Les transactions de valeur EOA de base d&#39;Ethereum ne comportent aucune disposition pour les signatures multiples ; cependant, des restrictions de signature arbitraires peuvent être appliquées par des contrats intelligents avec toutes les conditions auxquelles vous pouvez penser, pour gérer le transfert d&#39;ether et de jetons.</p>
</div>
<div class="paragraph">
<p>Pour tirer parti de cette capacité, l&#39;ether doit être transféré dans un &quot;contrat de portefeuille&quot; programmé avec les règles de dépenses souhaitées, telles que les exigences de multisignature ou les limites de dépenses (ou des combinaisons des deux). Le contrat de portefeuille envoie ensuite les fonds lorsqu&#39;il y est invité par un EOA autorisé une fois que les conditions de dépenses ont été remplies. Par exemple, pour protéger votre ether sous une condition multisig, transférez l&#39;ether vers un contrat multisig. Chaque fois que vous souhaitez envoyer des fonds vers un autre compte, tous les utilisateurs requis devront envoyer des transactions au contrat à l&#39;aide d&#39;une application de portefeuille standard, autorisant effectivement le contrat à effectuer en finale la <span class="keep-together">transaction</span>.</p>
</div>
<div class="paragraph">
<p>Ces contrats peuvent également être conçus pour exiger plusieurs signatures avant d&#39;exécuter du code local ou pour déclencher d&#39;autres contrats. La sécurité du système est finalement déterminée par le code de contrat multisig.</p>
</div>
<div class="paragraph">
<p>La possibilité de mettre en œuvre des transactions multisignatures en tant que contrat intelligent démontre la flexibilité d&#39;Ethereum. Cependant, c&#39;est une épée à double tranchant, car la flexibilité supplémentaire peut entraîner des bogues qui compromettent la sécurité des schémas multisignatures. Il existe, en fait, un certain nombre de propositions pour créer une commande multisignature dans l&#39;EVM qui supprime le besoin de contrats intelligents, du moins pour les simples schémas multisignatures M-de-N. Cela équivaudrait au système multisignature de Bitcoin, qui fait partie des règles de consensus de base et s&#39;est avéré robuste et sécurisé.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>Les transactions sont le point de départ de chaque activité dans le système Ethereum. Les transactions sont les &quot;entrées&quot; qui amènent la machine virtuelle Ethereum à évaluer les contrats, à mettre à jour les soldes et, plus généralement, à modifier l&#39;état de la chaîne de blocs Ethereum. Ensuite, nous travaillerons avec des contrats intelligents de manière beaucoup plus détaillée et apprendrons à programmer dans le langage orienté contrat de Solidity.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-05-15 00:34:58 -0400
</div>
</div>
</body>
</html>